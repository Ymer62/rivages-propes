(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery)}}(function(A){if(!Array.prototype.reduce){Array.prototype.reduce=function(R){var P=Object(this),N=P.length>>>0,O=0,Q;if(arguments.length===2){Q=arguments[1]}else{while(O<N&&!(O in P)){O++}if(O>=N){throw new TypeError("Reduce of empty array with no initial value")}Q=P[O++]}for(;O<N;O++){if(O in P){Q=R(Q,P[O],O,P)}}return Q}}if("function"!==typeof Array.prototype.filter){Array.prototype.filter=function(S){var R=Object(this),N=R.length>>>0;var Q=[];var O=arguments.length>=2?arguments[1]:void 0;for(var P=0;P<N;P++){if(P in R){var T=R[P];if(S.call(O,T,P,R)){Q.push(T)}}}return Q}}var t=typeof define==="function"&&define.amd;var j=function(P){if(P==="Roboto"){return true}var R=P==="Comic Sans MS"?"Courier New":"Comic Sans MS";var N=A("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body);var Q=N.css("fontFamily",R).width();var O=N.css("fontFamily",P+","+R).width();N.remove();return Q!==O};var B=navigator.userAgent;var L={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:/MSIE|Trident/i.test(B),isFF:/firefox/i.test(B),isWebkit:/webkit/i.test(B),isSafari:/safari/i.test(B),jqueryVersion:parseFloat(A.fn.jquery),isSupportAmd:t,hasCodeMirror:t?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:j,isW3CRangeSupport:!!document.createRange};var p=(function(){var Z=function(aa){return function(ab){return aa===ab}};var U=function(ab,aa){return ab===aa};var P=function(aa){return function(ac,ab){return ac[aa]===ab[aa]}};var W=function(){return true};var R=function(){return false};var Q=function(aa){return function(){return !aa.apply(aa,arguments)}};var T=function(ab,aa){return function(ac){return ab(ac)&&aa(ac)}};var Y=function(aa){return aa};var O=0;var V=function(aa){var ab=++O+"";return aa?aa+ab:ab};var N=function(aa){var ab=A(document);return{top:aa.top+ab.scrollTop(),left:aa.left+ab.scrollLeft(),width:aa.right-aa.left,height:aa.bottom-aa.top}};var S=function(ac){var aa={};for(var ab in ac){if(ac.hasOwnProperty(ab)){aa[ac[ab]]=ab}}return aa};var X=function(aa,ab){ab=ab||"";return ab+aa.split(".").map(function(ac){return ac.substring(0,1).toUpperCase()+ac.substring(1)}).join("")};return{eq:Z,eq2:U,peq2:P,ok:W,fail:R,self:Y,not:Q,and:T,uniqueId:V,rect2bnd:N,invertObject:S,namespaceToCamel:X}})();var q=(function(){var X=function(ab){return ab[0]};var aa=function(ab){return ab[ab.length-1]};var U=function(ab){return ab.slice(0,ab.length-1)};var V=function(ab){return ab.slice(1)};var T=function(af,ad){for(var ac=0,ab=af.length;ac<ab;ac++){var ae=af[ac];if(ad(ae)){return ae}}};var Z=function(ae,ad){for(var ac=0,ab=ae.length;ac<ab;ac++){if(!ad(ae[ac])){return false}}return true};var O=function(ac,ab){return A.inArray(ab,ac)!==-1};var S=function(ac,ab){ab=ab||p.self;return ac.reduce(function(ae,ad){return ae+ab(ad)},0)};var Y=function(ae){var ac=[],ab=-1,ad=ae.length;while(++ab<ad){ac[ab]=ae[ab]}return ac};var Q=function(ad,ab){if(!ad.length){return[]}var ac=V(ad);return ac.reduce(function(ag,af){var ae=aa(ag);if(ab(aa(ae),af)){ae[ae.length]=af}else{ag[ag.length]=[af]}return ag},[[X(ad)]])};var W=function(ae){var ad=[];for(var ac=0,ab=ae.length;ac<ab;ac++){if(ae[ac]){ad.push(ae[ac])}}return ad};var P=function(ae){var ad=[];for(var ac=0,ab=ae.length;ac<ab;ac++){if(!O(ad,ae[ac])){ad.push(ae[ac])}}return ad};var R=function(ad,ac){var ab=ad.indexOf(ac);if(ab===-1){return null}return ad[ab+1]};var N=function(ad,ac){var ab=ad.indexOf(ac);if(ab===-1){return null}return ad[ab-1]};return{head:X,last:aa,initial:U,tail:V,prev:N,next:R,find:T,contains:O,all:Z,sum:S,from:Y,clusterBy:Q,compact:W,unique:P}})();var M=String.fromCharCode(160);var H="\ufeff";var a=(function(){var R=function(a1){return a1&&A(a1).hasClass("note-editable")};var ax=function(a1){return a1&&A(a1).hasClass("note-control-sizing")};var aZ=function(a1){var a2;if(a1.hasClass("note-air-editor")){var a3=q.last(a1.attr("id").split("-"));a2=function(a4){return function(){return A(a4+a3)}};return{editor:function(){return a1},holder:function(){return a1.data("holder")},editable:function(){return a1},popover:a2("#note-popover-"),handle:a2("#note-handle-"),dialog:a2("#note-dialog-")}}else{a2=function(a4){return function(){return a1.find(a4)}};return{editor:function(){return a1},holder:function(){return a1.data("holder")},dropzone:a2(".note-dropzone"),toolbar:a2(".note-toolbar"),editable:a2(".note-editable"),codable:a2(".note-codable"),statusbar:a2(".note-statusbar"),popover:a2(".note-popover"),handle:a2(".note-handle"),dialog:a2(".note-dialog")}}};var au=function(a2){var a1=A(a2).closest(".note-editor, .note-air-editor, .note-air-layout");if(!a1.length){return null}var a3;if(a1.is(".note-editor, .note-air-editor")){a3=a1}else{a3=A("#note-editor-"+q.last(a1.attr("id").split("-")))}return aZ(a3)};var aV=function(a1){a1=a1.toUpperCase();return function(a2){return a2&&a2.nodeName.toUpperCase()===a1}};var W=function(a1){return a1&&a1.nodeType===3};var aP=function(a1){return a1&&/^BR|^IMG|^HR/.test(a1.nodeName.toUpperCase())};var T=function(a1){if(R(a1)){return false}return a1&&/^DIV|^P|^LI|^H[1-7]/.test(a1.nodeName.toUpperCase())};var aS=aV("LI");var aX=function(a1){return T(a1)&&!aS(a1)};var aK=aV("TABLE");var af=function(a1){return !N(a1)&&!O(a1)&&!T(a1)&&!aK(a1)&&!a0(a1)};var O=function(a1){return a1&&/^UL|^OL/.test(a1.nodeName.toUpperCase())};var X=function(a1){return a1&&/^TD|^TH/.test(a1.nodeName.toUpperCase())};var a0=aV("BLOCKQUOTE");var N=function(a1){return X(a1)||a0(a1)||R(a1)};var V=aV("A");var aC=function(a1){return af(a1)&&!!aB(a1,T)};var aD=function(a1){return af(a1)&&!aB(a1,T)};var Q=aV("BODY");var aA=function(a2,a1){return a2.nextSibling===a1||a2.previousSibling===a1};var ae=function(a2,a1){a1=a1||p.ok;var a3=[];if(a2.previousSibling&&a1(a2.previousSibling)){a3.push(a2.previousSibling)}a3.push(a2);if(a2.nextSibling&&a1(a2.nextSibling)){a3.push(a2.nextSibling)}return a3};var aN=L.isMSIE?"&nbsp;":"<br>";var S=function(a1){if(W(a1)){return a1.nodeValue.length}return a1.childNodes.length};var ah=function(a2){var a1=S(a2);if(a1===0){return true}else{if(!W(a2)&&a1===1&&a2.innerHTML===aN){return true}else{if(q.all(a2.childNodes,W)&&a2.innerHTML===""){return true}}}return false};var Z=function(a1){if(!aP(a1)&&!S(a1)){a1.innerHTML=aN}};var aB=function(a2,a1){while(a2){if(a1(a2)){return a2}if(R(a2)){break}a2=a2.parentNode}return null};var aL=function(a2,a1){a2=a2.parentNode;while(a2){if(S(a2)!==1){break}if(a1(a2)){return a2}if(R(a2)){break}a2=a2.parentNode}return null};var at=function(a3,a1){a1=a1||p.fail;var a2=[];aB(a3,function(a4){if(!R(a4)){a2.push(a4)}return a1(a4)});return a2};var P=function(a3,a1){var a2=at(a3);return q.last(a2.filter(a1))};var aj=function(a3,a2){var a1=at(a3);for(var a4=a2;a4;a4=a4.parentNode){if(A.inArray(a4,a1)>-1){return a4}}return null};var aI=function(a3,a2){a2=a2||p.fail;var a1=[];while(a3){if(a2(a3)){break}a1.push(a3);a3=a3.previousSibling}return a1};var ad=function(a3,a2){a2=a2||p.fail;var a1=[];while(a3){if(a2(a3)){break}a1.push(a3);a3=a3.nextSibling}return a1};var U=function(a2,a1){var a4=[];a1=a1||p.ok;(function a3(a7){if(a2!==a7&&a1(a7)){a4.push(a7)}for(var a6=0,a5=a7.childNodes.length;a6<a5;a6++){a3(a7.childNodes[a6])}})(a2);return a4};var aM=function(a3,a2){var a1=a3.parentNode;var a4=A("<"+a2+">")[0];a1.insertBefore(a4,a3);a4.appendChild(a3);return a4};var ac=function(a4,a3){var a2=a3.nextSibling,a1=a3.parentNode;if(a2){a1.insertBefore(a4,a2)}else{a1.appendChild(a4)}return a4};var aW=function(a1,a2){A.each(a2,function(a3,a4){a1.appendChild(a4)});return a1};var ak=function(a1){return a1.offset===0};var ay=function(a1){return a1.offset===S(a1.node)};var aF=function(a1){return ak(a1)||ay(a1)};var aO=function(a2,a1){while(a2&&a2!==a1){if(aH(a2)!==0){return false}a2=a2.parentNode}return true};var am=function(a2,a1){while(a2&&a2!==a1){if(aH(a2)!==S(a2.parentNode)-1){return false}a2=a2.parentNode}return true};var aH=function(a1){var a2=0;while((a1=a1.previousSibling)){a2+=1}return a2};var al=function(a1){return !!(a1&&a1.childNodes&&a1.childNodes.length)};var aa=function(a1,a2){var a3,a4;if(a1.offset===0){if(R(a1.node)){return null}a3=a1.node.parentNode;a4=aH(a1.node)}else{if(al(a1.node)){a3=a1.node.childNodes[a1.offset-1];a4=S(a3)}else{a3=a1.node;a4=a2?0:a1.offset-1}}return{node:a3,offset:a4}};var ag=function(a1,a2){var a3,a4;if(S(a1.node)===a1.offset){if(R(a1.node)){return null}a3=a1.node.parentNode;a4=aH(a1.node)+1}else{if(al(a1.node)){a3=a1.node.childNodes[a1.offset];a4=0}else{a3=a1.node;a4=a2?S(a1.node):a1.offset+1}}return{node:a3,offset:a4}};var ap=function(a1,a2){return a1.node===a2.node&&a1.offset===a2.offset};var ao=function(a1){if(W(a1.node)||!al(a1.node)||ah(a1.node)){return true}var a3=a1.node.childNodes[a1.offset-1];var a2=a1.node.childNodes[a1.offset];if((!a3||aP(a3))&&(!a2||aP(a2))){return true}return false};var aQ=function(a1,a2){while(a1){if(a2(a1)){return a1}a1=aa(a1)}return null};var az=function(a1,a2){while(a1){if(a2(a1)){return a1}a1=ag(a1)}return null};var aU=function(a1){if(!W(a1.node)){return false}var a2=a1.node.nodeValue.charAt(a1.offset-1);return a2&&(a2!==" "&&a2!==M)};var Y=function(a6,a3,a4,a2){var a1=a6;while(a1){a4(a1);if(ap(a1,a3)){break}var a5=a2&&a6.node!==a1.node&&a3.node!==a1.node;a1=ag(a1,a5)}};var ai=function(a1,a3){var a2=at(a3,p.eq(a1));return A.map(a2,aH).reverse()};var aR=function(a3,a4){var a5=a3;for(var a2=0,a1=a4.length;a2<a1;a2++){if(a5.childNodes.length<=a4[a2]){a5=a5.childNodes[a5.childNodes.length-1]}else{a5=a5.childNodes[a4[a2]]}}return a5};var aY=function(a1,a3){var a5=a3&&a3.isSkipPaddingBlankHTML;var a2=a3&&a3.isNotSplitEdgePoint;if(aF(a1)&&(W(a1.node)||a2)){if(ak(a1)){return a1.node}else{if(ay(a1)){return a1.node.nextSibling}}}if(W(a1.node)){return a1.node.splitText(a1.offset)}else{var a4=a1.node.childNodes[a1.offset];var a6=ac(a1.node.cloneNode(false),a1.node);aW(a6,ad(a4));if(!a5){Z(a1.node);Z(a6)}return a6}};var aG=function(a2,a1,a3){var a4=at(a1.node,p.eq(a2));if(!a4.length){return null}else{if(a4.length===1){return aY(a1,a3)}}return a4.reduce(function(a6,a5){if(a6===a1.node){a6=aY(a1,a3)}return aY({node:a5,offset:a6?a.position(a6):S(a5)},a3)})};var aw=function(a1,a6){var a4=a6?T:N;var a5=at(a1.node,a4);var a8=q.last(a5)||a1.node;var a7,a3;if(a4(a8)){a7=a5[a5.length-2];a3=a8}else{a7=a8;a3=a7.parentNode}var a2=a7&&aG(a7,a1,{isSkipPaddingBlankHTML:a6,isNotSplitEdgePoint:a6});if(!a2&&a3===a1.node){a2=a1.node.childNodes[a1.offset]}return{rightNode:a2,container:a3}};var ab=function(a1){return document.createElement(a1)};var aT=function(a1){return document.createTextNode(a1)};var ar=function(a5,a6){if(!a5||!a5.parentNode){return}if(a5.removeNode){return a5.removeNode(a6)}var a4=a5.parentNode;if(!a6){var a2=[];var a3,a1;for(a3=0,a1=a5.childNodes.length;a3<a1;a3++){a2.push(a5.childNodes[a3])}for(a3=0,a1=a2.length;a3<a1;a3++){a4.insertBefore(a2[a3],a5)}}a4.removeChild(a5)};var aE=function(a3,a1){while(a3){if(R(a3)||!a1(a3)){break}var a2=a3.parentNode;ar(a3);a3=a2}};var aq=function(a2,a3){if(a2.nodeName.toUpperCase()===a3.toUpperCase()){return a2}var a1=ab(a3);if(a2.style.cssText){a1.style.cssText=a2.style.cssText}aW(a1,q.from(a2.childNodes));ac(a1,a2);ar(a2);return a1};var an=aV("TEXTAREA");var aJ=function(a2,a1){var a3=an(a2[0])?a2.val():a2.html();if(a1){return a3.replace(/[\n\r]/g,"")}return a3};var av=function(a2,a3){var a1=aJ(a2);if(a3){var a4=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;a1=a1.replace(a4,function(a6,a9,a5){a5=a5.toUpperCase();var a8=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(a5)&&!!a9;var a7=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(a5);return a6+((a8||a7)?"\n":"")});a1=A.trim(a1)}return a1};return{NBSP_CHAR:M,ZERO_WIDTH_NBSP_CHAR:H,blank:aN,emptyPara:"<p>"+aN+"</p>",makePredByNodeName:aV,isEditable:R,isControlSizing:ax,buildLayoutInfo:aZ,makeLayoutInfo:au,isText:W,isVoid:aP,isPara:T,isPurePara:aX,isInline:af,isBlock:p.not(af),isBodyInline:aD,isBody:Q,isParaInline:aC,isList:O,isTable:aK,isCell:X,isBlockquote:a0,isBodyContainer:N,isAnchor:V,isDiv:aV("DIV"),isLi:aS,isBR:aV("BR"),isSpan:aV("SPAN"),isB:aV("B"),isU:aV("U"),isS:aV("S"),isI:aV("I"),isImg:aV("IMG"),isTextarea:an,isEmpty:ah,isEmptyAnchor:p.and(V,ah),isClosestSibling:aA,withClosestSiblings:ae,nodeLength:S,isLeftEdgePoint:ak,isRightEdgePoint:ay,isEdgePoint:aF,isLeftEdgeOf:aO,isRightEdgeOf:am,prevPoint:aa,nextPoint:ag,isSamePoint:ap,isVisiblePoint:ao,prevPointUntil:aQ,nextPointUntil:az,isCharPoint:aU,walkPoint:Y,ancestor:aB,singleChildAncestor:aL,listAncestor:at,lastAncestor:P,listNext:ad,listPrev:aI,listDescendant:U,commonAncestor:aj,wrap:aM,insertAfter:ac,appendChildNodes:aW,position:aH,hasChildren:al,makeOffsetPath:ai,fromOffsetPath:aR,splitTree:aG,splitPoint:aw,create:ab,createText:aT,remove:ar,removeWhile:aE,replace:aq,html:av,value:aJ}})();var i=(function(){var P=function(aa,Q){var T=aa.parentElement(),V;var Z=document.body.createTextRange(),X;var Y=q.from(T.childNodes);for(V=0;V<Y.length;V++){if(a.isText(Y[V])){continue}Z.moveToElementText(Y[V]);if(Z.compareEndPoints("StartToStart",aa)>=0){break}X=Y[V]}if(V!==0&&a.isText(Y[V-1])){var ab=document.body.createTextRange(),W=null;ab.moveToElementText(X||T);ab.collapse(!X);W=X?X.nextSibling:T.firstChild;var S=aa.duplicate();S.setEndPoint("StartToStart",ab);var R=S.text.replace(/[\r\n]/g,"").length;while(R>W.nodeValue.length&&W.nextSibling){R-=W.nodeValue.length;W=W.nextSibling}var U=W.nodeValue;if(Q&&W.nextSibling&&a.isText(W.nextSibling)&&R===W.nodeValue.length){R-=W.nodeValue.length;W=W.nextSibling}T=W;V=R}return{cont:T,offset:V}};var N=function(Q){var T=function(W,Z){var Y,V;if(a.isText(W)){var U=a.listPrev(W,p.not(a.isText));var X=q.last(U).previousSibling;Y=X||W.parentNode;Z+=q.sum(q.tail(U),a.nodeLength);V=!X}else{Y=W.childNodes[Z]||W;if(a.isText(Y)){return T(Y,0)}Z=0;V=false}return{node:Y,collapseToStart:V,offset:Z}};var R=document.body.createTextRange();var S=T(Q.node,Q.offset);R.moveToElementText(S.node);R.collapse(S.collapseToStart);R.moveStart("character",S.offset);return R};var O=function(V,U,R,Q){this.sc=V;this.so=U;this.ec=R;this.eo=Q;var T=function(){if(L.isW3CRangeSupport){var W=document.createRange();W.setStart(V,U);W.setEnd(R,Q);return W}else{var X=N({node:V,offset:U});X.setEndPoint("EndToEnd",N({node:R,offset:Q}));return X}};this.getPoints=function(){return{sc:V,so:U,ec:R,eo:Q}};this.getStartPoint=function(){return{node:V,offset:U}};this.getEndPoint=function(){return{node:R,offset:Q}};this.select=function(){var X=T();if(L.isW3CRangeSupport){var W=document.getSelection();if(W.rangeCount>0){W.removeAllRanges()}W.addRange(X)}else{X.select()}return this};this.normalize=function(){var Y=function(Z){if(!a.isVisiblePoint(Z)){if(a.isLeftEdgePoint(Z)){Z=a.nextPointUntil(Z,a.isVisiblePoint)}else{Z=a.prevPointUntil(Z,a.isVisiblePoint)}}return Z};var X=Y(this.getStartPoint());var W=Y(this.getEndPoint());return new O(X.node,X.offset,W.node,W.offset)};this.nodes=function(Y,Z){Y=Y||p.ok;var W=Z&&Z.includeAncestor;var ad=Z&&Z.fullyContains;var ab=this.getStartPoint();var aa=this.getEndPoint();var X=[];var ac=[];a.walkPoint(ab,aa,function(ae){if(a.isEditable(ae.node)){return}var af;if(ad){if(a.isLeftEdgePoint(ae)){ac.push(ae.node)}if(a.isRightEdgePoint(ae)&&q.contains(ac,ae.node)){af=ae.node}}else{if(W){af=a.ancestor(ae.node,Y)}else{af=ae.node}}if(af&&Y(af)){X.push(af)}},true);return q.unique(X)};this.commonAncestor=function(){return a.commonAncestor(V,R)};this.expand=function(W){var Y=a.ancestor(V,W);var Z=a.ancestor(R,W);if(!Y&&!Z){return new O(V,U,R,Q)}var X=this.getPoints();if(Y){X.sc=Y;X.so=0}if(Z){X.ec=Z;X.eo=a.nodeLength(Z)}return new O(X.sc,X.so,X.ec,X.eo)};this.collapse=function(W){if(W){return new O(V,U,V,U)}else{return new O(R,Q,R,Q)}};this.splitText=function(){var W=V===R;var X=this.getPoints();if(a.isText(R)&&!a.isEdgePoint(this.getEndPoint())){R.splitText(Q)}if(a.isText(V)&&!a.isEdgePoint(this.getStartPoint())){X.sc=V.splitText(U);X.so=0;if(W){X.ec=X.sc;X.eo=Q-U}}return new O(X.sc,X.so,X.ec,X.eo)};this.deleteContents=function(){if(this.isCollapsed()){return this}var X=this.splitText();var Y=X.nodes(null,{fullyContains:true});var W=a.prevPointUntil(X.getStartPoint(),function(aa){return !q.contains(Y,aa.node)});var Z=[];A.each(Y,function(aa,ac){var ab=ac.parentNode;if(W.node!==ab&&a.nodeLength(ab)===1){Z.push(ab)}a.remove(ac,false)});A.each(Z,function(aa,ab){a.remove(ab,false)});return new O(W.node,W.offset,W.node,W.offset).normalize()};var S=function(W){return function(){var X=a.ancestor(V,W);return !!X&&(X===a.ancestor(R,W))}};this.isOnEditable=S(a.isEditable);this.isOnList=S(a.isList);this.isOnAnchor=S(a.isAnchor);this.isOnCell=S(a.isCell);this.isLeftEdgeOf=function(W){if(!a.isLeftEdgePoint(this.getStartPoint())){return false}var X=a.ancestor(this.sc,W);return X&&a.isLeftEdgeOf(this.sc,X)};this.isCollapsed=function(){return V===R&&U===Q};this.wrapBodyInlineWithPara=function(){if(a.isBodyContainer(V)&&a.isEmpty(V)){V.innerHTML=a.emptyPara;return new O(V.firstChild,0,V.firstChild,0)}if(a.isParaInline(V)||a.isPara(V)){return this.normalize()}var Z;if(a.isInline(V)){var X=a.listAncestor(V,p.not(a.isInline));Z=q.last(X);if(!a.isInline(Z)){Z=X[X.length-2]||V.childNodes[U]}}else{Z=V.childNodes[U>0?U-1:0]}var Y=a.listPrev(Z,a.isParaInline).reverse();Y=Y.concat(a.listNext(Z.nextSibling,a.isParaInline));if(Y.length){var W=a.wrap(q.head(Y),"p");a.appendChildNodes(W,q.tail(Y))}return this.normalize()};this.insertNode=function(X){var W=this.wrapBodyInlineWithPara().deleteContents();var Y=a.splitPoint(W.getStartPoint(),a.isInline(X));if(Y.rightNode){Y.rightNode.parentNode.insertBefore(X,Y.rightNode)}else{Y.container.appendChild(X)}return X};this.pasteHTML=function(Y){var X=this;var W=A("<div></div>").html(Y)[0];var Z=q.from(W.childNodes);this.wrapBodyInlineWithPara().deleteContents();return A.map(Z.reverse(),function(aa){return X.insertNode(aa)}).reverse()};this.toString=function(){var W=T();return L.isW3CRangeSupport?W.toString():W.text};this.getWordRange=function(Y){var W=this.getEndPoint();if(!a.isCharPoint(W)){return this}var X=a.prevPointUntil(W,function(Z){return !a.isCharPoint(Z)});if(Y){W=a.nextPointUntil(W,function(Z){return !a.isCharPoint(Z)})}return new O(X.node,X.offset,W.node,W.offset)};this.bookmark=function(W){return{s:{path:a.makeOffsetPath(W,V),offset:U},e:{path:a.makeOffsetPath(W,R),offset:Q}}};this.paraBookmark=function(W){return{s:{path:q.tail(a.makeOffsetPath(q.head(W),V)),offset:U},e:{path:q.tail(a.makeOffsetPath(q.last(W),R)),offset:Q}}};this.getClientRects=function(){var W=T();return W.getClientRects()}};return{create:function(V,S,U,Q){if(!arguments.length){if(L.isW3CRangeSupport){var Y=document.getSelection();if(!Y||Y.rangeCount===0){return null}else{if(a.isBody(Y.anchorNode)){return null}}var X=Y.getRangeAt(0);V=X.startContainer;S=X.startOffset;U=X.endContainer;Q=X.endOffset}else{var aa=document.selection.createRange();var T=aa.duplicate();T.collapse(false);var Z=aa;Z.collapse(true);var R=P(Z,true),W=P(T,false);if(a.isText(R.node)&&a.isLeftEdgePoint(R)&&a.isTextNode(W.node)&&a.isRightEdgePoint(W)&&W.node.nextSibling===R.node){R=W}V=R.cont;S=R.offset;U=W.cont;Q=W.offset}}else{if(arguments.length===2){U=V;Q=S}}return new O(V,S,U,Q)},createFromNode:function(S){var U=S;var T=0;var R=S;var Q=a.nodeLength(R);if(a.isVoid(U)){T=a.listPrev(U).length-1;U=U.parentNode}if(a.isBR(R)){Q=a.listPrev(R).length-1;R=R.parentNode}else{if(a.isVoid(R)){Q=a.listPrev(R).length;R=R.parentNode}}return this.create(U,T,R,Q)},createFromNodeBefore:function(Q){return this.createFromNode(Q).collapse(true)},createFromNodeAfter:function(Q){return this.createFromNode(Q).collapse()},createFromBookmark:function(S,T){var V=a.fromOffsetPath(S,T.s.path);var U=T.s.offset;var R=a.fromOffsetPath(S,T.e.path);var Q=T.e.offset;return new O(V,U,R,Q)},createFromParaBookmark:function(T,S){var U=T.s.offset;var Q=T.e.offset;var V=a.fromOffsetPath(q.head(S),T.s.path);var R=a.fromOffsetPath(q.last(S),T.e.path);return new O(V,U,R,Q)}}})();var C={version:"0.6.9",options:{defaultTextColor:"#212121",defaultBackColor:"#ddd",followingToolbar:true,otherStaticBarClass:"staticTop",width:null,height:null,minHeight:null,maxHeight:null,focus:false,tabsize:4,styleWithSpan:true,disableLinkTarget:false,disableDragAndDrop:false,disableResizeEditor:false,shortcuts:true,placeholder:false,prettifyHtml:true,iconPrefix:"",icons:{font:{bold:"format_bold",italic:"format_italic",underline:"format_underlined",clear:"clear",height:"format_size",strikethrough:"strikethrough_s",superscript:"vertical_align_top",subscript:"vertical_align_bottom"},image:{image:"image",floatLeft:"format_align_left",floatRight:"format_align_right",floatNone:"format_align_justify",shapeRounded:"crop_3_2",shapeCircle:"panorama_fish_eye",shapeThumbnail:"collections",bordered:"border_outer",shapeNone:"image",remove:"delete"},link:{link:"insert_link",unlink:"clear",edit:"create"},table:{table:"border_all"},hr:{insert:"add"},style:{style:"border_color"},lists:{unordered:"format_list_bulleted",ordered:"format_list_numbered"},options:{help:"help",fullscreen:"settings_overscan",codeview:"code"},paragraph:{paragraph:"format_textdirection_l_to_r",outdent:"format_indent_decrease",indent:"format_indent_increase",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify"},color:{recent:"format_color_text"},history:{undo:"undo",redo:"redo"},misc:{check:"check"}},codemirror:{mode:"text/html",htmlMode:true,indentWithTabs:true,tabSize:4,lineNumbers:true,theme:"monokai",maxHighlightLength:"Infinity"},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],plugin:{},airMode:false,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Roboto",fontNames:["Roboto","Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],fontSizes:["12","13","14","15","16","17","18","25","37"],colors:[["#fafafa","#efebe9","#7e57c2","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#66bb6a","#9ccc65","#ffee58","#ffca28","#ffa726","#ff7043","#ef5350","#ec407a"],["#f5f5f5","#d7ccc8","#673ab7","#9c27b0","#3f51b5","#2196f3","#00bcd4","#4caf50","#8bc34a","#ffeb3b","#ffc107","#ff9800","#ff5722","#f44336","#e91e63"],["#eeeeee","#bcaaa4","#5e35b1","#8e24aa","#3949ab","#1e88e5","#00acc1","#43a047","#7cb342","#fdd835","#ffb300","#fb8c00","#f4511e","#e53935","#d81b60"],["#e0e0e0","#a1887f","#512da8","#7b1fa2","#303f9f","#1976d2","#0097a7","#388e3c","#689f38","#fbc02d","#ffa000","#f57c00","#e64a19","#d32f2f","#c2185b"],["#bdbdbd","#8d6e63","#4527a0","#6a1b9a","#283593","#1565c0","#00838f","#2e7d32","#558b2f","#f9a825","#ff8f00","#ef6c00","#d84315","#c62828","#ad1457"],["#9e9e9e","#795548","#311b92","#4a148c","#1a237e","#0d47a1","#006064","#1b5e20","#33691e","#f57f17","#ff6f00","#e65100","#bf360c","#b71c1c","#880e4f"],["#757575","#6d4c41","#b388ff","#ea80fc","#8c9eff","#82b1ff","#84ffff","#b9f6ca","#ccff90","#ffff8d","#ffe57f","#ffd180","#ff9e80","#ff8a80","#ff80ab"],["#616161","#5d4037","#7c4dff","#e040fb","#536dfe","#448aff","#18ffff","#69f0ae","#b2ff59","#ffff00","#ffd740","#ffab40","#ff6e40","#ff5252","#ff4081"],["#424242","#4e342e","#651fff","#d500f9","#3d5afe","#2979ff","#00e5ff","#00e676","#76ff03","#ffea00","#ffc400","#ff9100","#ff3d00","#ff1744","#f50057"],["#212121","#3e2723","#6200ea","#aa00ff","#304ffe","#2962ff","#00b8d4","#00c853","#64dd17","#ffd600","#ffab00","#ff6d00","#dd2c00","#d50000","#c51162"],],colorTitles:[["grey lighten5","brown lighten5","deep-purple lighten1","purple lighten1","indigo lighten1","blue lighten1","cyan lighten1","green lighten1","light-green lighten1","yellow lighten1","amber lighten1","orange lighten1","deep-orange lighten1","red lighten1","pink lighten1"],["grey lighten4","brown lighten4","deep-purple","purple","indigo","blue","cyan","green","light-green","yellow","amber","orange","deep-orange","red","pink"],["grey lighten3","brown lighten3","deep-purple darken1","purple darken1","indigo darken1","blue darken1","cyan darken1","green darken1","light-green darken1","yellow darken1","amber darken1","orange darken1","deep-orange darken1","red darken1","pink darken1"],["grey lighten2","brown lighten2","deep-purple darken2","purple darken2","indigo darken2","blue darken2","cyan darken2","green darken2","light-green darken2","yellow darken2","amber darken2","orange darken2","deep-orange darken2","red darken2","pink darken2"],["grey lighten1","brown lighten1","deep-purple darken3","purple darken3","indigo darken3","blue darken3","cyan darken3","green darken3","light-green darken3","yellow darken3","amber darken3","orange darken3","deep-orange darken3","red darken3","pink darken3"],["grey","brown","deep-purple darken4","purple darken4","indigo darken4","blue darken4","cyan darken4","green darken4","light-green darken4","yellow darken4","amber darken4","orange darken4","deep-orange darken4","red darken4","pink darken4"],["grey darken1","brown darken1","deep-purple accent1","purple accent1","indigo accent1","blue accent1","cyan accent1","green accent1","light-green accent1","yellow accent1","amber accent1","orange accent1","deep-orange accent1","red accent1","pink accent1"],["grey darken2","brown darken2","deep-purple accent2","purple accent2","indigo accent2","blue accent2","cyan accent2","green accent2","light-green accent2","yellow accent2","amber accent2","orange accent2","deep-orange accent2","red accent2","pink accent2"],["grey darken3","brown darken3","deep-purple accent3","purple accent3","indigo accent3","blue accent3","cyan accent3","green accent3","light-green accent3","yellow accent3","amber accent3","orange accent3","deep-orange accent3","red accent3","pink accent3"],["grey darken4","brown darken4","deep-purple accent4","purple accent4","indigo accent4","blue accent4","cyan accent4","green accent4","light-green accent4","yellow accent4","amber accent4","orange accent4","deep-orange accent4","red accent4","pink accent4"],],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:12,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(N){if(N.indexOf("@")!==-1&&N.indexOf(":")===-1){N="mailto:"+N}return N},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",bordered:"Bordered",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",striped:"Striped",hoverable:"Hoverable",responsive:"Responsive",bordered:"Bordered"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Back",foreground:"Text",transparent:"Transparent",setTransparent:"Transparent",reset:"Reset",resetToDefault:"Default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},history:{undo:"Undo",redo:"Redo"}}}};var F=(function(){var N=function(P){return A.Deferred(function(Q){A.extend(new FileReader(),{onload:function(S){var R=S.target.result;Q.resolve(R)},onerror:function(){Q.reject(this)}}).readAsDataURL(P)}).promise()};var O=function(Q,P){return A.Deferred(function(R){var S=A("<img>");S.one("load",function(){S.off("error abort");R.resolve(S)}).one("error abort",function(){S.off("load").detach();R.reject(S)}).css({display:"none"}).appendTo(document.body).attr({src:Q,"data-filename":P})}).promise()};return{readFileAsDataURL:N,createImage:O}})();var o=(function(){var N={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{isEdit:function(O){return q.contains([8,9,13,32],O)},isMove:function(O){return q.contains([37,38,39,40],O)},nameFromCode:p.invertObject(N),code:N}})();var h=function(Q){var O=[],P=-1;var R=Q[0];var N=function(){var T=i.create();var U={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:Q.html(),bookmark:(T?T.bookmark(R):U)}};var S=function(T){if(T.contents!==null){Q.html(T.contents)}if(T.bookmark!==null){i.createFromBookmark(R,T.bookmark).select()}};this.undo=function(){if(0<P){P--;S(O[P])}};this.redo=function(){if(O.length-1>P){P++;S(O[P])}};this.recordUndo=function(){P++;if(O.length>P){O=O.slice(0,P)}O.push(N())};this.recordUndo()};var y=function(){var N=function(Q,P){if(L.jqueryVersion<1.9){var O={};A.each(P,function(R,S){O[S]=Q.css(S)});return O}return Q.css.call(Q,P)};this.stylePara=function(O,P){A.each(O.nodes(a.isPara,{includeAncestor:true}),function(R,Q){A(Q).css(P)})};this.styleNodes=function(O,S){O=O.splitText();var V=S&&S.nodeName||"SPAN";var T=!!(S&&S.expandClosestSibling);var R=!!(S&&S.onlyPartialContains);if(O.isCollapsed()){return[O.insertNode(a.create(V))]}var Q=a.makePredByNodeName(V);var P=A.map(O.nodes(a.isText,{fullyContains:true}),function(W){return a.singleChildAncestor(W,Q)||a.wrap(W,V)});if(T){if(R){var U=O.nodes();Q=p.and(Q,function(W){return q.contains(U,W)})}return A.map(P,function(X){var Z=a.withClosestSiblings(X,Q);var W=q.head(Z);var Y=q.tail(Z);A.each(Y,function(aa,ab){a.appendChildNodes(W,ab.childNodes);a.remove(ab)});return q.head(Z)})}else{return P}};this.current=function(O,S){var V=A(a.isText(O.sc)?O.sc.parentNode:O.sc);var T=["font-family","font-size","text-align","list-style-type","line-height"];var R=N(V,T)||{};R["font-size"]=parseInt(R["font-size"],10);R["font-bold"]=document.queryCommandState("bold")?"bold":"normal";R["font-italic"]=document.queryCommandState("italic")?"italic":"normal";R["font-underline"]=document.queryCommandState("underline")?"underline":"normal";R["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal";R["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal";R["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal";if(!O.isOnList()){R["list-style"]="none"}else{var Q=["circle","disc","disc-leading-zero","square"];var P=A.inArray(R["list-style-type"],Q)>-1;R["list-style"]=P?"unordered":"ordered"}var W=a.ancestor(O.sc,a.isPara);if(W&&W.style["line-height"]){R["line-height"]=W.style.lineHeight}else{var U=parseInt(R["line-height"],10)/parseInt(R["font-size"],10);R["line-height"]=U.toFixed(1)}R.image=a.isImg(S)&&S;R.anchor=O.isOnAnchor()&&a.ancestor(O.sc,a.isAnchor);R.ancestors=a.listAncestor(O.sc,a.isEditable);R.range=O;return R}};var E=function(){this.insertOrderedList=function(){this.toggleList("OL")};this.insertUnorderedList=function(){this.toggleList("UL")};this.indent=function(){var O=this;var N=i.create().wrapBodyInlineWithPara();var P=N.nodes(a.isPara,{includeAncestor:true});var Q=q.clusterBy(P,p.peq2("parentNode"));A.each(Q,function(R,S){var T=q.head(S);if(a.isLi(T)){O.wrapList(S,T.parentNode.nodeName)}else{A.each(S,function(V,U){A(U).css("marginLeft",function(W,X){return(parseInt(X,10)||0)+25})})}});N.select()};this.outdent=function(){var O=this;var N=i.create().wrapBodyInlineWithPara();var P=N.nodes(a.isPara,{includeAncestor:true});var Q=q.clusterBy(P,p.peq2("parentNode"));A.each(Q,function(R,S){var T=q.head(S);if(a.isLi(T)){O.releaseList([S])}else{A.each(S,function(V,U){A(U).css("marginLeft",function(W,X){X=(parseInt(X,10)||0);return X>25?X-25:""})})}});N.select()};this.toggleList=function(R){var O=this;var N=i.create().wrapBodyInlineWithPara();var Q=N.nodes(a.isPara,{includeAncestor:true});var S=N.paraBookmark(Q);var U=q.clusterBy(Q,p.peq2("parentNode"));if(q.find(Q,a.isPurePara)){var P=[];A.each(U,function(V,W){P=P.concat(O.wrapList(W,R))});Q=P}else{var T=N.nodes(a.isList,{includeAncestor:true}).filter(function(V){return !A.nodeName(V,R)});if(T.length){A.each(T,function(V,W){a.replace(W,R)})}else{Q=this.releaseList(U,true)}}i.createFromParaBookmark(S,Q).select()};this.wrapList=function(Q,P){var R=q.head(Q);var T=q.last(Q);var O=a.isList(R.previousSibling)&&R.previousSibling;var N=a.isList(T.nextSibling)&&T.nextSibling;var S=O||a.insertAfter(a.create(P||"UL"),T);Q=A.map(Q,function(U){return a.isPurePara(U)?a.replace(U,"LI"):U});a.appendChildNodes(S,Q);if(N){a.appendChildNodes(S,q.from(N.childNodes));a.remove(N)}return Q};this.releaseList=function(P,N){var O=[];A.each(P,function(Q,R){var S=q.head(R);var T=q.last(R);var W=N?a.lastAncestor(S,a.isList):S.parentNode;var V=W.childNodes.length>1?a.splitTree(W,{node:T.parentNode,offset:a.position(T)+1},{isSkipPaddingBlankHTML:true}):null;var U=a.splitTree(W,{node:S.parentNode,offset:a.position(S)},{isSkipPaddingBlankHTML:true});R=N?a.listDescendant(U,a.isLi):q.from(U.childNodes).filter(a.isLi);if(N||!a.isList(W.parentNode)){R=A.map(R,function(Y){return a.replace(Y,"P")})}A.each(q.from(R).reverse(),function(Z,Y){a.insertAfter(Y,W)});var X=q.compact([W,U,V]);A.each(X,function(Y,Z){var aa=[Z].concat(a.listDescendant(Z,a.isList));A.each(aa.reverse(),function(ab,ac){if(!a.nodeLength(ac)){a.remove(ac,true)}})});O=O.concat(R)});return O}};var c=function(){var N=new E();this.insertTab=function(Q,P,O){var R=a.createText(new Array(O+1).join(a.NBSP_CHAR));P=P.deleteContents();P.insertNode(R,true);P=i.create(R,O);P.select()};this.insertParagraph=function(){var P=i.create();P=P.deleteContents();P=P.wrapBodyInlineWithPara();var S=a.ancestor(P.sc,a.isPara);var R;if(S){if(a.isEmpty(S)&&a.isLi(S)){N.toggleList(S.parentNode.nodeName);return}else{R=a.splitTree(S,P.getStartPoint());var O=a.listDescendant(S,a.isEmptyAnchor);O=O.concat(a.listDescendant(R,a.isEmptyAnchor));A.each(O,function(T,U){a.remove(U)})}}else{var Q=P.sc.childNodes[P.so];R=A(a.emptyPara)[0];if(Q){P.sc.insertBefore(R,Q)}else{P.sc.appendChild(R)}}i.create(R,0).normalize().select()}};var g=function(){this.tab=function(O,Q){var N=a.ancestor(O.commonAncestor(),a.isCell);var S=a.ancestor(N,a.isTable);var P=a.listDescendant(S,a.isCell);var R=q[Q?"prev":"next"](P,N);if(R){i.create(R,0).select()}};this.createTable=function(W){var S=[],P;var R=[];var X=W[0];var V=W[1];var Q=W.slice(2,W.length);for(var T=0;T<X;T++){S.push("<td>(item)</td>");R.push("<th>header</th>")}P=S.join("");R=R.join("");var U=[],N;for(var O=0;O<V;O++){U.push("<tr>"+P+"</tr>")}N=U.join("");return A('<table class="'+Q.join(" ")+'"><thead><tr>'+R+"</tr></thead><tbody>"+N+"</tbody></table>")[0]}};var d="bogus";var s=function(X){var O=new y();var W=new g();var U=new c();var N=new E();this.createRange=function(aa){this.focus(aa);return i.create()};this.saveRange=function(aa,ab){this.focus(aa);aa.data("range",i.create());if(ab){i.create().collapse().select()}};this.saveNode=function(ab){var ad=[];for(var ac=0,aa=ab[0].childNodes.length;ac<aa;ac++){ad.push(ab[0].childNodes[ac])}ab.data("childNodes",ad)};this.restoreRange=function(ab){var aa=ab.data("range");if(aa){aa.select();this.focus(ab)}};this.restoreNode=function(ab){ab.html("");var ad=ab.data("childNodes");for(var ac=0,aa=ad.length;ac<aa;ac++){ab[0].appendChild(ad[ac])}};this.currentStyle=function(ab){var aa=i.create();return aa?aa.isOnEditable()&&O.current(aa,ab):false};var V=function(aa){var ab=a.makeLayoutInfo(aa).holder();X.bindCustomEvent(ab,aa.data("callbacks"),"before.command")(aa.html(),aa)};var Q=function(aa){var ab=a.makeLayoutInfo(aa).holder();X.bindCustomEvent(ab,aa.data("callbacks"),"change")(aa.html(),aa)};this.undo=function(aa){V(aa);aa.data("NoteHistory").undo();Q(aa)};this.redo=function(aa){V(aa);aa.data("NoteHistory").redo();Q(aa)};var Y=this;var T=this.beforeCommand=function(aa){V(aa);Y.focus(aa)};var Z=this.afterCommand=function(aa,ab){aa.data("NoteHistory").recordUndo();if(!ab){Q(aa)}};var P=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"];for(var S=0,R=P.length;S<R;S++){this[P[S]]=(function(aa){return function(ab,ac){T(ab);document.execCommand(aa,false,ac);Z(ab,true)}})(P[S])}this.insertHorizontalRule=function(){var aa=A("<div />");aa.addClass("divider");i.create().insertNode(aa[0])};this.tab=function(ab,ac){var aa=this.createRange(ab);if(aa.isCollapsed()&&aa.isOnCell()){W.tab(aa)}else{T(ab);U.insertTab(ab,aa,ac.tabsize);Z(ab)}};this.untab=function(ab){var aa=this.createRange(ab);if(aa.isCollapsed()&&aa.isOnCell()){W.tab(aa,true)}};this.insertParagraph=function(aa){T(aa);U.insertParagraph(aa);Z(aa)};this.insertOrderedList=function(aa){T(aa);N.insertOrderedList(aa);Z(aa)};this.insertUnorderedList=function(aa){T(aa);N.insertUnorderedList(aa);Z(aa)};this.indent=function(aa){T(aa);N.indent(aa);Z(aa)};this.outdent=function(aa){T(aa);N.outdent(aa);Z(aa)};this.insertImage=function(ab,ac,aa){F.createImage(ac,aa).then(function(ad){T(ab);ad.css({display:"",width:Math.min(ab.width(),ad.width())});i.create().insertNode(ad[0]);i.createFromNodeAfter(ad[0]).select();Z(ab)}).fail(function(){var ad=a.makeLayoutInfo(ab).holder();X.bindCustomEvent(ad,ab.data("callbacks"),"image.upload.error")()})};this.insertNode=function(aa,ab){T(aa);i.create().insertNode(ab);i.createFromNodeAfter(ab).select();Z(aa)};this.insertText=function(aa,ac){T(aa);var ab=i.create().insertNode(a.createText(ac));i.create(ab,a.nodeLength(ab)).select();Z(aa)};this.pasteHTML=function(ab,aa){T(ab);var ac=i.create().pasteHTML(aa);i.createFromNodeAfter(q.last(ac)).select();Z(ab)};this.formatBlock=function(aa,ab){T(aa);ab=L.isMSIE?"<"+ab+">":ab;document.execCommand("FormatBlock",false,ab);Z(aa)};this.formatPara=function(aa){T(aa);this.formatBlock(aa,"P");Z(aa)};for(var S=1;S<=6;S++){this["formatH"+S]=function(aa){return function(ab){this.formatBlock(ab,"H"+aa)}}(S)}this.fontSize=function(ac,af){var aa=i.create();var ab=aa.isCollapsed();if(ab){var ad=O.styleNodes(aa);var ae=q.head(ad);A(ad).css({"font-size":af+"px"});if(ae&&!a.nodeLength(ae)){ae.innerHTML=a.ZERO_WIDTH_NBSP_CHAR;i.createFromNodeAfter(ae.firstChild).select();ac.data(d,ae)}}else{T(ac);A(O.styleNodes(aa)).css({"font-size":af+"px"});Z(ac)}};this.removeBogus=function(ac){var ab=ac.data(d);if(!ab){return}var ad=q.find(q.from(ab.childNodes),a.isText);var aa=ad.nodeValue.indexOf(a.ZERO_WIDTH_NBSP_CHAR);if(aa!==-1){ad.deleteData(aa,1)}if(a.isEmpty(ab)){a.remove(ab)}ac.removeData(d)};this.lineHeight=function(aa,ab){T(aa);O.stylePara(i.create(),{lineHeight:ab});Z(aa)};this.unlink=function(ab){var aa=this.createRange(ab);if(aa.isOnAnchor()){var ac=a.ancestor(aa.sc,a.isAnchor);aa=i.createFromNode(ac);aa.select();T(ab);document.execCommand("unlink");Z(ab)}};this.createLink=function(al,ag,an){var ah=ag.url;var ad=ag.text;var ak=ag.newWindow;var aa=ag.range;var am=aa.toString()!==ad;T(al);if(an.onCreateLink){ah=an.onCreateLink(ah)}var ab=[];if(am){var af=aa.insertNode(A("<A>"+ad+"</A>")[0]);ab.push(af)}else{ab=O.styleNodes(aa,{nodeName:"A",expandClosestSibling:true,onlyPartialContains:true})}A.each(ab,function(ao,ap){A(ap).attr("href",ah);if(ak){A(ap).attr("target","_blank")}else{A(ap).removeAttr("target")}});var aj=i.createFromNodeBefore(q.head(ab));var ac=aj.getStartPoint();var ae=i.createFromNodeAfter(q.last(ab));var ai=ae.getEndPoint();i.create(ac.node,ac.offset,ai.node,ai.offset).select();Z(al)};this.getLinkInfo=function(ab){this.focus(ab);var aa=i.create().expand(a.isAnchor);var ac=A(q.head(aa.nodes(a.isAnchor)));return{range:aa,text:aa.toString(),isNewWindow:ac.length?ac.attr("target")==="_blank":false,url:ac.length?ac.attr("href"):""}};this.color=function(ab,ac){var ae=JSON.parse(ac);var ad=ae.foreColor,aa=ae.backColor;T(ab);if(ad){document.execCommand("foreColor",false,ad)}if(aa){document.execCommand("backColor",false,aa)}Z(ab)};this.insertTable=function(ad,aa){var ac=aa.split("x");T(ad);var ab=i.create().deleteContents();ab.insertNode(W.createTable(ac));Z(ad)};this.floatMe=function(ab,ac,aa){T(ab);aa.css("float",ac);Z(ab)};this.imageShape=function(ab,ac,aa){T(ab);aa.removeClass("img-rounded img-circle img-thumbnail img-bordered");if(ac){aa.addClass(ac)}Z(ab)};this.imageClass=function(ab,ac,aa){T(ab);if(ac){if(aa.hasClass(ac)){aa.removeClass(ac)}else{aa.addClass(ac)}}Z(ab)};this.resize=function(ab,ac,aa){T(ab);aa.css({width:ac*100+"%",height:""});Z(ab)};this.resizeTo=function(af,aa,ab){var ae;if(ab){var ad=af.y/af.x;var ac=aa.data("ratio");ae={width:ac>ad?af.x:af.y/ac,height:ac>ad?af.x*ac:af.y}}else{ae={width:af.x,height:af.y}}aa.css(ae)};this.removeMedia=function(ab,ac,aa){T(ab);aa.detach();X.bindCustomEvent(A(),ab.data("callbacks"),"media.delete")(aa,ab);Z(ab)};this.focus=function(aa){aa.focus();if(L.isFF&&!i.create().isOnEditable()){i.createFromNode(aa[0]).normalize().collapse().select()}};this.isEmpty=function(aa){return a.isEmpty(aa[0])||a.emptyPara===aa.html()}};var I=function(){this.update=function(aa,S){var O=function(ab,ac){ab.find(".dropdown-menu li").each(function(){var ae=A(this).children("div");var ad=ae.data("value");if((ad+"")===(ac+"")){ae.children("i").removeClass("transparent")}else{ae.children("i").addClass("transparent")}})};var Y=function(ab,ac){var ad=aa.find(ab);ad.toggleClass("active",ac())};if(S.image){var P=A(S.image);Y('.btn[data-event="imageClass"][data-value="img-rounded"]',function(){return P.hasClass("img-rounded")});Y('.btn[data-event="imageClass"][data-value="img-circle"]',function(){return P.hasClass("img-circle")});Y('.btn[data-event="imageClass"][data-value="img-thumbnail"]',function(){return P.hasClass("img-thumbnail")});Y('.btn[data-event="imageClass"][data-value="img-bordered"]',function(){return P.hasClass("img-bordered")});Y('.btn[data-event="imageShape"]:not([data-value])',function(){return !P.is(".img-rounded, .img-circle, .img-thumbnail, .img-bordered")});var Z=P.css("float");Y('.btn[data-event="floatMe"][data-value="left"]',function(){return Z==="left"});Y('.btn[data-event="floatMe"][data-value="right"]',function(){return Z==="right"});Y('.btn[data-event="floatMe"][data-value="none"]',function(){return Z!=="left"&&Z!=="right"});var Q=P.attr("style");Y('.btn[data-event="resize"][data-value="1"]',function(){return !!/(^|\s)(max-)?width\s*:\s*100%/.test(Q)});Y('.btn[data-event="resize"][data-value="0.5"]',function(){return !!/(^|\s)(max-)?width\s*:\s*50%/.test(Q)});Y('.btn[data-event="resize"][data-value="0.25"]',function(){return !!/(^|\s)(max-)?width\s*:\s*25%/.test(Q)});return}var R=aa.find(".note-fontname[data-name=fontname]");if(R.length){var V=S["font-family"];if(!!V){var X=V.split(",");for(var U=0,W=X.length;U<W;U++){V=X[U].replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"");if(L.isFontInstalled(V)){break}}R.find(".note-current-fontname").text(V);O(R,V)}}var N=aa.find(".note-fontsize[data-name=fontsize]");N.find(".note-current-fontsize").text(S["font-size"]);O(N,parseFloat(S["font-size"]));var T=aa.find(".note-height[data-name=lineheight]");O(T,parseFloat(S["line-height"]));Y('.btn[data-event="bold"]',function(){return S["font-bold"]==="bold"});Y('.btn[data-event="italic"]',function(){return S["font-italic"]==="italic"});Y('.btn[data-event="underline"]',function(){return S["font-underline"]==="underline"});Y('.btn[data-event="strikethrough"]',function(){return S["font-strikethrough"]==="strikethrough"});Y('.btn[data-event="superscript"]',function(){return S["font-superscript"]==="superscript"});Y('.btn[data-event="subscript"]',function(){return S["font-subscript"]==="subscript"});Y('.btn[data-event="justifyLeft"]',function(){return S["text-align"]==="left"||S["text-align"]==="start"});Y('.btn[data-event="justifyCenter"]',function(){return S["text-align"]==="center"});Y('.btn[data-event="justifyRight"]',function(){return S["text-align"]==="right"});Y('.btn[data-event="justifyFull"]',function(){return S["text-align"]==="justify"});Y('.btn[data-event="insertUnorderedList"]',function(){return S["list-style"]==="unordered"});Y('.btn[data-event="insertOrderedList"]',function(){return S["list-style"]==="ordered"})};this.updateRecentColor=function(O,N,S){var T=A(O).closest(".note-color");var Q=T.find(".note-recent-color");var P=JSON.parse(Q.attr("data-value"));var R=N==="backColor"?"background-color":"color";P[N]=S;Q.attr("data-value",JSON.stringify(P));Q.css(R,S)}};var k=function(){var N=new I();this.update=function(O,P){N.update(O,P)};this.updateRecentColor=function(P,O,Q){N.updateRecentColor(P,O,Q)};this.activate=function(O){O.find("button, .btn").not('.btn[data-event="codeview"]').removeClass("disabled")};this.deactivate=function(O){O.find("button, .btn").not('.btn[data-event="codeview"]').addClass("disabled")};this.updateFullscreen=function(Q,P){var O=Q.find('.btn[data-event="fullscreen"]');O.toggleClass("active",P)};this.updateCodeview=function(Q,O){var P=Q.find('.btn[data-event="codeview"]');P.toggleClass("active",O);if(O){this.deactivate(Q)}else{this.activate(Q)}};this.get=function(O,Q){var P=a.makeLayoutInfo(O).toolbar();return P.find("[data-name="+Q+"]")};this.setButtonState=function(O,P,Q){Q=(Q===false)?false:true;var R=this.get(O,P);R.toggleClass("active",Q)}};var J=24;var v=function(){var N=A(document);this.attach=function(Q,P){if(!P.disableResizeEditor){Q.statusbar().on("mousedown",O)}};var O=function(S){S.preventDefault();S.stopPropagation();var P=a.makeLayoutInfo(S.target).editable();var R=P.offset().top-N.scrollTop();var T=a.makeLayoutInfo(S.currentTarget||S.target);var Q=T.editor().data("options");N.on("mousemove",function(V){var U=V.clientY-(R+J);U=(Q.minHeight>0)?Math.max(U,Q.minHeight):U;U=(Q.maxHeight>0)?Math.min(U,Q.maxHeight):U;P.height(U)}).one("mouseup",function(){N.off("mousemove")})}};var x=function(){var O=new I();var N=function(U,T){var S=A(U);var V=T?S.offset():S.position();var R=S.outerHeight(true);return{left:V.left,top:V.top+R}};var Q=function(R,S){R.css({display:"block",left:S.left,top:S.top})};var P=20;this.update=function(U,V,T){O.update(U,V);var W=U.find(".note-link-popover");if(V.anchor){var ab=W.find("a");var S=A(V.anchor).attr("href");var X=A(V.anchor).attr("target");ab.attr("href",S).html(S);if(!X){ab.removeAttr("target")}else{ab.attr("target","_blank")}Q(W,N(V.anchor,T))}else{W.hide()}var R=U.find(".note-image-popover");if(V.image){Q(R,N(V.image,T))}else{R.hide()}var Y=U.find(".note-air-popover");if(T&&!V.range.isCollapsed()){var aa=q.last(V.range.getClientRects());if(aa){var Z=p.rect2bnd(aa);Q(Y,{left:Math.max(Z.left+Z.width/2-P,0),top:Z.top+Z.height})}}else{Y.hide()}};this.updateRecentColor=function(S,R,T){S.updateRecentColor(S,R,T)};this.hide=function(R){R.children().hide()}};var K=function(O){var P=A(document);var N=function(Q){if(a.isControlSizing(Q.target)){Q.preventDefault();Q.stopPropagation();var W=a.makeLayoutInfo(Q.target),R=W.handle(),Y=W.popover(),aa=W.editable(),S=W.editor();var Z=R.find(".note-control-selection").data("target"),U=A(Z),X=U.offset(),T=P.scrollTop();var V=S.data("options").airMode;P.on("mousemove",function(ab){O.invoke("editor.resizeTo",{x:ab.clientX-X.left,y:ab.clientY-(X.top-T)},U,!ab.shiftKey);O.invoke("handle.update",R,{image:Z},V);O.invoke("popover.update",Y,{image:Z},V)}).one("mouseup",function(){P.off("mousemove");O.invoke("editor.afterCommand",aa)});if(!U.data("ratio")){U.data("ratio",U.height()/U.width())}}};this.attach=function(Q){Q.handle().on("mousedown",N)};this.update=function(X,V,T){var Q=X.find(".note-control-selection");if(V.image){var R=A(V.image);var W=T?R.offset():R.position();var S={w:R.outerWidth(true),h:R.outerHeight(true)};Q.css({display:"block",left:W.left,top:W.top,width:S.w,height:S.h}).data("target",V.image);var U=S.w+"x"+S.h;Q.find(".note-control-selection-info").text(U)}else{Q.hide()}};this.hide=function(Q){Q.children().hide()}};var l=function(O){var P=A(window);var N=A("html, body");this.toggle=function(W){var V=W.editor(),T=W.toolbar(),R=W.editable(),Q=W.codable();var S=function(X){R.css("height",X.h);Q.css("height",X.h);if(Q.data("cmeditor")){Q.data("cmeditor").setsize(null,X.h)}};V.toggleClass("fullscreen");var U=V.hasClass("fullscreen");if(U){R.data("orgheight",R.css("height"));P.on("resize",function(){S({h:P.height()-T.outerHeight()})}).trigger("resize");N.css("overflow","hidden");T.css("top",0)}else{P.off("resize");S({h:R.data("orgheight")});N.css("overflow","visible")}O.invoke("toolbar.updateFullscreen",T,U)}};var r;if(L.hasCodeMirror){if(L.isSupportAmd){require(["CodeMirror"],function(N){r=N})}else{r=window.CodeMirror}}var w=function(N){this.sync=function(P){var O=N.invoke("codeview.isActivated",P);if(O&&L.hasCodeMirror){P.codable().data("cmEditor").save()}};this.isActivated=function(P){var O=P.editor();return O.hasClass("codeview")};this.toggle=function(O){if(this.isActivated(O)){this.deactivate(O)}else{this.activate(O)}};this.activate=function(U){var Q=U.editor(),S=U.toolbar(),aa=U.editable(),W=U.codable(),V=U.popover(),P=U.handle();var ac=Q.data("options");var R=a.html(aa,false);function ab(ae,ad,ai,aj){var af=ae.indexOf("<");var ah=ae.indexOf(">");var ak;if(af===0){ak=ae.substring(0,ah+1);ae=ae.substring(ah+1);if(ak.indexOf("</")===0){ad--;nsideLastBlock=false}else{if(ai){ad++}var al=false;for(var ag=0;ag<aj.length;ag++){if(ak.indexOf(aj[ag])===0){al=true;break}}if(!al){ai=true}else{ai=false}}}else{ak=ae.substring(0,af);ae=ae.substring(af);if(ai){ad++}ai=false}ak=new Array(ad+1).join("    ")+ak.trim();if(ae.length===0){return ak}return ak+"\n"+ab(ae.trim(),ad,ai,aj)}var X=["<img","<br","<hr"];R=ab(R,0,false,X);W.val(R);var Z=S.find(".btn[data-event=codeview]").height();var Y=A(window).height()-Z;W.height(aa.height());N.invoke("toolbar.updateCodeview",S,true);N.invoke("popover.hide",V);N.invoke("handle.hide",P);Q.addClass("codeview");W.focus();if(L.hasCodeMirror){var O=r.fromTextArea(W[0],ac.codemirror);if(ac.codemirror.tern){var T=new r.TernServer(ac.codemirror.tern);O.ternServer=T;O.on("cursorActivity",function(ad){T.updateArgHints(ad)})}if(Q.hasClass("fullscreen")){O.setSize(null,Y)}else{O.setSize(null,aa.outerHeight())}W.data("cmEditor",O)}};this.deactivate=function(R){var S=R.holder(),P=R.editor(),Q=R.toolbar(),W=R.editable(),U=R.codable();var X=P.data("options");if(L.hasCodeMirror){var O=U.data("cmEditor");U.val(O.getValue());O.toTextArea()}var V=a.value(U,X.prettifyHtml)||a.emptyPara;var T=W.html()!==V;W.html(V);W.height(X.height?U.height():"auto");P.removeClass("codeview");if(T){N.bindCustomEvent(S,W.data("callbacks"),"change")(W.html(),W)}W.focus();N.invoke("toolbar.updateCodeview",Q,false)}};var z=function(N){var O=A(document);this.attach=function(Q,P){if(P.airMode||P.disableDragAndDrop){O.on("drop",function(R){R.preventDefault()})}else{this.attachDragAndDropEvent(Q,P)}};this.attachDragAndDropEvent=function(S,P){var T=A(),R=S.editor(),U=S.dropzone(),Q=U.find(".note-dropzone-message");O.on("dragenter",function(X){var W=N.invoke("codeview.isActivated",S);var V=R.width()>0&&R.height()>0;if(!W&&!T.length&&V){R.addClass("dragover");U.width(R.width());U.height(R.height());Q.text(P.langInfo.image.dragImageHere)}T=T.add(X.target)}).on("dragleave",function(V){T=T.not(V.target);if(!T.length){R.removeClass("dragover")}}).on("drop",function(){T=A();R.removeClass("dragover")});U.on("dragenter",function(){U.addClass("hover");Q.text(P.langInfo.image.dropImage)}).on("dragleave",function(){U.removeClass("hover");Q.text(P.langInfo.image.dragImageHere)});U.on("drop",function(aa){var ab=aa.originalEvent.dataTransfer;var ac=a.makeLayoutInfo(aa.currentTarget||aa.target);if(ab&&ab.files&&ab.files.length){aa.preventDefault();ac.editable().focus();N.insertImages(ac,ab.files)}else{var W=function(){ac.holder().materialnote("insertNode",this)};for(var X=0,V=ab.types.length;X<V;X++){var Y=ab.types[X];var Z=ab.getData(Y);if(Y.toLowerCase().indexOf("text")>-1){ac.holder().materialnote("pasteHTML",Z)}else{A(Z).each(W)}}}}).on("dragover",false)}};var m=function(O){var N;this.attach=function(Q){if(window.clipboardData||L.isFF){N=A("<div />").attr("contenteditable",true).css({position:"absolute",left:-100000,opacity:0});Q.editable().after(N);N.one("paste",P);Q.editable().on("keydown",function(R){if(R.ctrlKey&&R.keyCode===86){O.invoke("saveRange",Q.editable());if(N){N.focus()}}})}Q.editable().on("paste",P)};var P=function(U){var W=U.originalEvent.clipboardData;var V=a.makeLayoutInfo(U.currentTarget||U.target);var Q=V.editable();if(!W||!W.items||!W.items.length){var T=Q.data("callbacks");if(!T.onImageUpload){return}setTimeout(function(){if(!N){return}var ab=N[0].firstChild;if(!ab){return}O.invoke("restoreRange",Q);if(!a.isImg(ab)){O.invoke("pasteHTML",Q,N.html())}else{var Z=ab.src;var aa=atob(Z.split(",")[1]);var ac=new Uint8Array(aa.length);for(var Y=0;Y<aa.length;Y++){ac[Y]=aa.charCodeAt(Y)}var X=new Blob([ac],{type:"image/png"});X.name="clipboard.png";O.invoke("focus",Q);O.insertImages(V,[X])}N.remove()},0);return}var S=q.head(W.items);var R=S.kind==="file"&&S.type.indexOf("image/")!==-1;if(R){O.insertImages(V,[S.getAsFile()])}O.invoke("editor.afterCommand",Q)}};var G=function(N){var O=function(R,Q){R.toggleClass("disabled",!Q);R.attr("disabled",!Q)};var P=function(R,Q){R.on("keypress",function(S){if(S.keyCode===o.code.ENTER){Q.trigger("click")}})};this.showLinkDialog=function(Q,S,R){return A.Deferred(function(W){var X=S.find(".note-link-dialog");var V=X.find(".note-link-text"),Z=V.next("label"),aa=X.find(".note-link-url"),U=X.find(".note-link-btn"),Y=X.find(".btnClose");var T=X.find("input[type=checkbox]");X.modal("open");V.val(R.text);if(R.text.length>0){Z.addClass("active")}V.on("keyup",function(){O(U,V.val()&&aa.val());R.text=V.val()});Y.click(function(ab){ab.preventDefault();X.modal("close")});if(!R.url){R.url=R.text||"http://";O(U,R.text)}aa.on("keyup",function(){O(U,V.val()&&aa.val());if(!R.text){Z.addClass("active");V.val(aa.val())}}).val(R.url).trigger("focus").trigger("select");P(aa,U);P(V,U);T.prop("checked",R.newWindow);U.one("click",function(ab){ab.preventDefault();W.resolve({range:R.range,url:aa.val(),text:V.val(),newWindow:T.is(":checked")});A(".note-link-text").val("");A(".note-link-text").next("label").removeClass("active");A(".note-link-url").val("");X.modal("close")})}).promise()};this.show=function(W){var V=W.editor(),U=W.dialog(),Q=W.editable(),T=W.popover(),S=N.invoke("editor.getLinkInfo",Q);var R=V.data("options");N.invoke("editor.saveRange",Q);this.showLinkDialog(Q,U,S).then(function(X){N.invoke("editor.restoreRange",Q);N.invoke("editor.createLink",Q,X,R);N.invoke("popover.hide",T)}).fail(function(){N.invoke("editor.restoreRange",Q)})}};var u=function(N){var O=function(R,Q){R.toggleClass("disabled",!Q);R.attr("disabled",!Q)};var P=function(R,Q){R.on("keypress",function(S){if(S.keyCode===o.code.ENTER){Q.trigger("click")}})};this.show=function(S){var R=S.dialog(),Q=S.editable();N.invoke("editor.saveRange",Q);this.showImageDialog(Q,R).then(function(T){N.invoke("editor.restoreRange",Q);if(typeof T==="string"){N.invoke("editor.insertImage",Q,T)}else{N.insertImages(S,T)}}).fail(function(){N.invoke("editor.restoreRange",Q)})};this.showImageDialog=function(Q,R){return A.Deferred(function(U){var X=R.find(".note-image-dialog");var W=R.find(".note-image-input"),S=R.find(".note-image-url"),T=R.find(".note-image-btn"),V=X.find(".btnClose");X.modal("open");W.replaceWith(W.clone().on("change",function(){U.resolve(this.files||this.value);S.val("");X.modal("close");U.resolve()}).val(""));T.click(function(Y){Y.preventDefault();U.resolve(S.val());S.val("");X.modal("close");U.resolve()});V.click(function(Y){Y.preventDefault();X.modal("close")});S.on("keyup paste",function(Z){var Y;if(Z.type==="paste"){Y=Z.originalEvent.clipboardData.getData("text")}else{Y=S.val()}O(T,Y)});P(S,T)})}};var b=function(N){this.showHelpDialog=function(O,P){return A.Deferred(function(Q){var R=P.find(".note-help-dialog");R.modal("open");Q.resolve()}).promise()};this.show=function(Q){var P=Q.dialog(),O=Q.editable();N.invoke("editor.saveRange",O,true);this.showHelpDialog(O,P).then(function(){N.invoke("editor.restoreRange",O)})}};var e=function(){var R=this.modules={editor:new s(this),toolbar:new k(this),statusbar:new v(this),popover:new x(this),handle:new K(this),fullscreen:new l(this),codeview:new w(this),dragAndDrop:new z(this),clipboard:new m(this),linkDialog:new G(this),imageDialog:new u(this),helpDialog:new b(this)};this.invoke=function(){var ac=q.head(q.from(arguments));var aa=q.tail(q.from(arguments));var ae=ac.split(".");var ad=ae.length>1;var Z=ad&&q.head(ae);var Y=ad?q.last(ae):q.head(ae);var ab=this.getModule(Z);var af=ab[Y];return af&&af.apply(ab,aa)};this.getModule=function(Y){return this.modules[Y]||this.modules.editor};var U=this.bindCustomEvent=function(aa,Z,Y){return function(){var ab=Z[p.namespaceToCamel(Y,"on")];if(ab){ab.apply(aa[0],arguments)}return aa.trigger("materialnote."+Y,arguments)}};this.insertImages=function(ae,ab){var ad=ae.editor(),Y=ae.editable(),ac=ae.holder();var aa=Y.data("callbacks");var Z=ad.data("options");if(aa.onImageUpload){U(ac,aa,"image.upload")(ab)}else{A.each(ab,function(af,ah){var ag=ah.name;if(Z.maximumImageFileSize&&Z.maximumImageFileSize<ah.size){U(ac,aa,"image.upload.error")(Z.langInfo.image.maximumFileSizeError)}else{F.readFileAsDataURL(ah).then(function(ai){R.editor.insertImage(Y,ai,ag)}).fail(function(){U(ac,aa,"image.upload.error")(Z.langInfo.image.maximumFileSizeError)})}})}};var Q={showLinkDialog:function(Y){R.linkDialog.show(Y)},showImageDialog:function(Y){R.imageDialog.show(Y)},showHelpDialog:function(Y){R.helpDialog.show(Y)},fullscreen:function(Y){R.fullscreen.toggle(Y)},codeview:function(Y){R.codeview.toggle(Y)}};var X=function(Y){if(a.isImg(Y.target)){Y.preventDefault()}};var W=function(Y){var Z=a.makeLayoutInfo(Y.currentTarget||Y.target);R.editor.removeBogus(Z.editable());O(Y)};var O=function(Y){setTimeout(function(){var aa=a.makeLayoutInfo(Y.currentTarget||Y.target);var ab=R.editor.currentStyle(Y.target);if(!ab){return}var Z=aa.editor().data("options").airMode;if(!Z){R.toolbar.update(aa.toolbar(),ab)}R.popover.update(aa.popover(),ab,Z);R.handle.update(aa.handle(),ab,Z)},0)};var T=function(Y){var Z=a.makeLayoutInfo(Y.currentTarget||Y.target);R.popover.hide(Z.popover());R.handle.hide(Z.handle())};var V=function(Z){var Y=A(Z.target).closest("[data-event]");if(Y.length){Z.preventDefault()}};var P=function(Y){var af=A(Y.target).closest("[data-event]");if(af.length){var ae=af.attr("data-event"),ag=af.attr("data-value"),ad=af.attr("data-hide");var ab=a.makeLayoutInfo(Y.target);var aa;if(A.inArray(ae,["resize","floatMe","removeMedia","imageShape","imageClass"])!==-1){var ac=ab.handle().find(".note-control-selection");aa=A(ac.data("target"))}if(ad){af.parents(".popover").hide()}if(A.isFunction(A.materialnote.pluginEvents[ae])){A.materialnote.pluginEvents[ae](Y,R.editor,ab,ag)}else{if(R.editor[ae]){var ah=ab.editable();ah.focus();R.editor[ae](ah,ag,aa);Y.preventDefault()}else{if(Q[ae]){Q[ae].call(this,ab);Y.preventDefault()}}}if(A.inArray(ae,["backColor","foreColor"])!==-1){var ai=ab.editor().data("options",ai);var Z=ai.airMode?R.popover:R.toolbar;Z.updateRecentColor(q.head(af),ae,ag)}O(Y)}};var N=26;var S=function(Z,an){var ac=A(Z.target.parentNode);var ai=ac.parent();var aa=ac.next();var ah=ac.find(".note-dimension-picker-mousecatcher");var ad=ac.find(".note-dimension-picker-highlighted");var ae=ac.find(".note-dimension-picker-unhighlighted");var ak=ai.find("[id$='-hoverable']");var am=ai.find("[id$='-bordered']");var al=ai.find("[id$='-striped']");var ab=ai.find("[id$='-responsive']");var ag;if(Z.offsetX===undefined){var Y=A(Z.target).offset();ag={x:Z.pageX-Y.left,y:Z.pageY-Y.top}}else{ag={x:Z.offsetX,y:Z.offsetY}}var af={c:Math.ceil(ag.x/N)||1,r:Math.ceil(ag.y/N)||1};var aj=[];if(ak.is(":checked")){aj.push("hoverable")}if(am.is(":checked")){aj.push("bordered")}if(al.is(":checked")){aj.push("striped")}if(ab.is(":checked")){aj.push("responsive-table")}ad.css({width:(af.c*N)+"px",height:(af.r*N)+"px"});ah.attr("data-value",af.c+"x"+af.r+"x"+aj.join("x"));ae.css({width:(an.insertTableMaxSize*N)+"px"});if(3<af.r&&af.r<an.insertTableMaxSize.row){ae.css({height:((af.r+1)*N)+"px"})}aa.html(af.c+" x "+af.r)};this.bindKeyMap=function(aa,ab){var Z=aa.editor();var Y=aa.editable();Y.on("keydown",function(ah){var ag=[];if(ah.metaKey){ag.push("CMD")}if(ah.ctrlKey&&!ah.altKey){ag.push("CTRL")}if(ah.shiftKey){ag.push("SHIFT")}var af=o.nameFromCode[ah.keyCode];if(af){ag.push(af)}var ae;var ad=ag.join("+");var ac=ab[ad];if(ac){ae=A.materialnote.pluginEvents[ad];if(A.isFunction(ae)){if(ae(ah,R.editor,aa)){return false}}ae=A.materialnote.pluginEvents[ac];if(A.isFunction(ae)){ae(ah,R.editor,aa)}else{if(R.editor[ac]){R.editor[ac](Y,Z.data("options"));ah.preventDefault()}else{if(Q[ac]){Q[ac].call(this,aa);ah.preventDefault()}}}}else{if(o.isEdit(ah.keyCode)){R.editor.afterCommand(Y)}}})};this.attach=function(ab,Z){if(Z.shortcuts){this.bindKeyMap(ab,Z.keyMap[L.isMac?"mac":"pc"])}ab.editable().on("mousedown",X);ab.editable().on("keyup mouseup",W);ab.editable().on("scroll",T);R.clipboard.attach(ab,Z);R.handle.attach(ab,Z);ab.popover().on("click",P);ab.popover().on("mousedown",V);R.dragAndDrop.attach(ab,Z);if(!Z.airMode){ab.toolbar().on("click",P);ab.toolbar().on("mousedown",V);R.statusbar.attach(ab,Z)}var Y=Z.airMode?ab.popover():ab.toolbar();var ac=Y.find(".note-dimension-picker-mousecatcher");ac.css({width:Z.insertTableMaxSize.col*N+"px",height:Z.insertTableMaxSize.row*N+"px"}).on("mousemove",function(ad){S(ad,Z)});ab.editor().data("options",Z);if(!L.isMSIE){setTimeout(function(){document.execCommand("styleWithCSS",0,Z.styleWithSpan)},0)}var aa=new h(ab.editable());ab.editable().data("NoteHistory",aa);ab.editable().data("callbacks",{onInit:Z.onInit,onFocus:Z.onFocus,onBlur:Z.onBlur,onKeydown:Z.onKeydown,onKeyup:Z.onKeyup,onMousedown:Z.onMousedown,onEnter:Z.onEnter,onPaste:Z.onPaste,onBeforeCommand:Z.onBeforeCommand,onChange:Z.onChange,onImageUpload:Z.onImageUpload,onImageUploadError:Z.onImageUploadError,onMediaDelete:Z.onMediaDelete,onToolbarClick:Z.onToolbarClick});if(a.isTextarea(q.head(ab.holder()))){ab.holder().closest("form").submit(function(){ab.holder().val(ab.holder().code())})}};this.attachCustomEvent=function(af,aa){var ae=af.holder();var Z=af.editable();var ad=Z.data("callbacks");Z.focus(U(ae,ad,"focus"));Z.blur(U(ae,ad,"blur"));Z.keydown(function(ag){if(ag.keyCode===o.code.ENTER){U(ae,ad,"enter").call(this,ag)}U(ae,ad,"keydown").call(this,ag)});Z.keyup(U(ae,ad,"keyup"));Z.on("mousedown",U(ae,ad,"mousedown"));Z.on("mouseup",U(ae,ad,"mouseup"));Z.on("scroll",U(ae,ad,"scroll"));Z.on("paste",U(ae,ad,"paste"));var ac=L.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";Z.on(ac,function(){U(ae,ad,"change")(Z.html(),Z)});if(!aa.airMode){af.toolbar().click(U(ae,ad,"toolbar.click"));af.popover().click(U(ae,ad,"popover.click"))}if(a.isTextarea(q.head(ae))){ae.closest("form").submit(function(ag){U(ae,ad,"submit").call(this,ag,ae.code())})}U(ae,ad,"init")(af);for(var ab=0,Y=A.materialnote.plugins.length;ab<Y;ab++){if(A.isFunction(A.materialnote.plugins[ab].init)){A.materialnote.plugins[ab].init(af)}}};this.detach=function(Z,Y){Z.holder().off();Z.editable().off();Z.popover().off();Z.handle().off();Z.dialog().off();if(!Y.airMode){Z.dropzone().off();Z.toolbar().off();Z.statusbar().off()}}};var f=function(){var P=function(aq,au){var ai=au.event;var ar=au.value;var ap=au.title;var aj=au.style;var al=au.btnClassName;var ao=au.className;var at=au.dropdown;var am=au.hide;if(!at){var ak=['<div class="waves-effect waves-light btn',(ao?" "+ao:"")+'"',(ap?' title="'+ap+'"':""),(aj?' style="'+aj+'"':""),(ai?' data-event="'+ai+'"':""),(ar?" data-value='"+ar+"'":""),(am?" data-hide='"+am+"'":""),' tabindex="-1">'+aq+"</div>"].join("");return ak}else{var an=['<div class="btn-group',(ao?" "+ao:"")+'">','<button class="waves-effect waves-light btn dropdown '+(al?al:"")+'"',(ap?' title="'+ap+'"':""),(ai?' data-event="'+ai+'"':""),(ar?" data-value='"+ar+"'":""),(am?" data-hide='"+am+"'":""),'><i class="material-icons left">arrow_drop_down</i>'+aq+"</button>",at,"</div>"].join("");return an}};var T=function(ak,aj){var ai='<i class="material-icons">'+ak+"</i>";return P(ai,aj)};var Y=function(ai,ak){var aj=A('<div class="'+ai+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content"></div></div>');aj.find(".popover-content").append(ak);return aj};var ah=function(aj,al,ai,am){var ak=['<div class="'+aj+' modal modal-fixed-footer">','<div class="modal-content">',(al?"<h4>"+al+"</h4>":""),"<p>"+ai+"</p>","</div>",(am?'<div class="modal-footer">'+am+"</div>":""),"</div>"].join("");return ak};var ad={picture:function(aj,ai){return T(ai.iconPrefix+ai.icons.image.image,{event:"showImageDialog",title:aj.image.image,hide:true})},link:function(aj,ai){return T(ai.iconPrefix+ai.icons.link.link,{event:"showLinkDialog",title:aj.link.link,hide:true})},table:function(aj,ai){var ak='<ul class="note-table dropdown-menu"><div class="row"><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-bordered" checked="checked" /><label for="'+materialUniqueId+'-bordered">'+aj.table.bordered+'</label></div><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-striped" checked="checked" /><label for="'+materialUniqueId+'-striped">'+aj.table.striped+'</label></div></div><div class="row"><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-hoverable" checked="checked" /><label for="'+materialUniqueId+'-hoverable">'+aj.table.hoverable+'</label></div><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-responsive" checked="checked" /><label for="'+materialUniqueId+'-responsive">'+aj.table.responsive+'</label></div></div><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return T(ai.iconPrefix+ai.icons.table.table,{title:aj.table.table,dropdown:ak})},style:function(ak,aj){var ai=aj.styleTags.reduce(function(am,al){var an=ak.style[al==="p"?"normal":al];return am+'<li><div data-event="formatBlock" data-value="'+al+'">'+((al==="p"||al==="pre")?an:"<"+al+">"+an+"</"+al+">")+"</div></li>"},"");return T(aj.iconPrefix+aj.icons.style.style,{title:ak.style.style,dropdown:'<ul class="dropdown-menu largeDropdown">'+ai+"</ul>"})},fontname:function(an,ak){var am=[];var ai=ak.fontNames.reduce(function(aq,ap){if(!L.isFontInstalled(ap)&&ak.fontNamesIgnoreCheck.indexOf(ap)===-1){return aq}am.push(ap);return aq+'<li><div data-event="fontName" href="#" data-value="'+ap+'" style="font-family:\''+ap+'\'"><i class="material-icons tiny transparent">'+ak.iconPrefix+ak.icons.misc.check+"</i> "+ap+"</div></li>"},"");var ao=L.isFontInstalled(ak.defaultFontName);var al=(ao)?ak.defaultFontName:am[0];var aj='<div class="note-current-fontname">'+al+"</div>";return P(aj,{title:an.font.name,className:"note-fontname",dropdown:'<ul class="dropdown-menu note-check">'+ai+"</ul>"})},fontsize:function(al,ak){var ai=ak.fontSizes.reduce(function(an,am){return an+'<li><div data-event="fontSize" href="#" data-value="'+am+'"><i class="material-icons tiny transparent">'+ak.iconPrefix+ak.icons.misc.check+"</i> "+am+"</div></li>"},"");var aj='<span class="note-current-fontsize">15</span>';return P(aj,{title:al.font.size,className:"note-fontsize",dropdown:'<ul class="dropdown-menu note-check">'+ai+"</ul>"})},color:function(am,aj){var al='<i class="material-icons">'+aj.icons.color.recent+"</i>",ai=P(al,{className:"note-recent-color",title:am.color.recent,style:"color: "+aj.defaultTextColor+"; background-color: "+aj.defaultBackColor+";",event:"color",value:'{"backColor": "'+aj.defaultBackColor+'"}'});var an='<ul id="colors" class="dropdown-menu"><li><div class="col s12"><ul class="tabs"><li class="tab"><a href="#'+materialUniqueId+'-foreColor" class="active">'+am.color.foreground+'</a></li><li class="tab"><a href="#'+materialUniqueId+'-backColor">'+am.color.background+'</a></li></ul></div><div class="col s12 colorTable"><div id="'+materialUniqueId+'-foreColor"><div class="note-color-reset waves-effect waves-light btn" data-event="foreColor" data-value="'+aj.defaultTextColor+'" title="'+am.color.reset+'">'+am.color.resetToDefault+'</div><div class="colorName"></div><div class="note-color-palette" data-target-event="foreColor"></div></div><div id="'+materialUniqueId+'-backColor"><div class="note-color-reset waves-effect waves-light btn" data-event="backColor" data-value="'+aj.defaultBackColor+'" title="'+am.color.transparent+'">'+am.color.setTransparent+'</div><div class="colorName"></div><div class="note-color-palette" data-target-event="backColor"></div></div></div></li></ul>';var ak=P("",{title:am.color.more,className:"closeLeft",dropdown:an});return ak+ai},bold:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.bold,{event:"bold",title:aj.font.bold})},italic:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.italic,{event:"italic",title:aj.font.italic})},underline:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.underline,{event:"underline",title:aj.font.underline})},strikethrough:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.strikethrough,{event:"strikethrough",title:aj.font.strikethrough})},superscript:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.superscript,{event:"superscript",title:aj.font.superscript})},subscript:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.subscript,{event:"subscript",title:aj.font.subscript})},clear:function(aj,ai){return T(ai.iconPrefix+ai.icons.font.clear,{event:"removeFormat",title:aj.font.clear})},ul:function(aj,ai){return T(ai.iconPrefix+ai.icons.lists.unordered,{event:"insertUnorderedList",title:aj.lists.unordered})},ol:function(aj,ai){return T(ai.iconPrefix+ai.icons.lists.ordered,{event:"insertOrderedList",title:aj.lists.ordered})},leftButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.left,{title:aj.paragraph.left,event:"justifyLeft"})},centerButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.center,{title:aj.paragraph.center,event:"justifyCenter"})},rightButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.right,{title:aj.paragraph.right,event:"justifyRight"})},justifyButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.justify,{title:aj.paragraph.justify,event:"justifyFull"})},outdentButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.outdent,{title:aj.paragraph.outdent,event:"outdent"})},indentButton:function(aj,ai){return T(ai.iconPrefix+ai.icons.paragraph.indent,{title:aj.paragraph.indent,event:"indent"})},paragraph:function(ai,aq){var aj=T(aq.iconPrefix+aq.icons.paragraph.left,{title:ai.paragraph.left,event:"justifyLeft"});var an=T(aq.iconPrefix+aq.icons.paragraph.center,{title:ai.paragraph.center,event:"justifyCenter"});var al=T(aq.iconPrefix+aq.icons.paragraph.right,{title:ai.paragraph.right,event:"justifyRight"});var ak=T(aq.iconPrefix+aq.icons.paragraph.justify,{title:ai.paragraph.justify,event:"justifyFull"});var ao=T(aq.iconPrefix+aq.icons.paragraph.outdent,{title:ai.paragraph.outdent,event:"outdent"});var am=T(aq.iconPrefix+aq.icons.paragraph.indent,{title:ai.paragraph.indent,event:"indent"});var ap='<ul class="dropdown-menu"><div class="note-align btn-group">'+aj+an+al+ak+'</div><div class="note-list btn-group">'+am+ao+"</div></ul>";return T(aq.iconPrefix+aq.icons.paragraph.paragraph,{title:ai.paragraph.paragraph,dropdown:ap})},lineheight:function(ak,aj){var ai=aj.lineHeights.reduce(function(am,al){return am+'<li><div data-event="lineHeight" href="#" data-value="'+parseFloat(al)+'"><i class="material-icons tiny transparent">'+aj.iconPrefix+aj.icons.misc.check+"</i> "+al+"</div></li>"},"");return T(aj.iconPrefix+aj.icons.font.height,{title:ak.font.height,className:"note-height",dropdown:'<ul class="dropdown-menu note-check">'+ai+"</ul>"})},help:function(aj,ai){return T(ai.iconPrefix+ai.icons.options.help,{event:"showHelpDialog",title:aj.options.help,hide:true})},fullscreen:function(aj,ai){return T(ai.iconPrefix+ai.icons.options.fullscreen,{event:"fullscreen",title:aj.options.fullscreen})},codeview:function(aj,ai){return T(ai.iconPrefix+ai.icons.options.codeview,{event:"codeview",title:aj.options.codeview})},undo:function(aj,ai){return T(ai.iconPrefix+ai.icons.history.undo,{event:"undo",title:aj.history.undo})},redo:function(aj,ai){return T(ai.iconPrefix+ai.icons.history.redo,{event:"redo",title:aj.history.redo})},hr:function(aj,ai){return T(ai.iconPrefix+ai.icons.hr.insert,{event:"insertHorizontalRule",title:aj.hr.insert})}};var Q=function(an,ai){var am=function(){var ao=T(ai.iconPrefix+ai.icons.link.edit,{title:an.link.edit,event:"showLinkDialog",hide:true});var aq=T(ai.iconPrefix+ai.icons.link.unlink,{title:an.link.unlink,event:"unlink"});var ap='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+ao+aq+"</div>";return Y("note-link-popover",ap)};var ak=function(){var aq=P('<span class="note-fontsize-10">100%</span>',{title:an.image.resizeFull,event:"resize",value:"1"});var ao=P('<span class="note-fontsize-10">50%</span>',{title:an.image.resizeHalf,event:"resize",value:"0.5"});var aw=P('<span class="note-fontsize-10">25%</span>',{title:an.image.resizeQuarter,event:"resize",value:"0.25"});var ap=T(ai.iconPrefix+ai.icons.image.floatLeft,{title:an.image.floatLeft,event:"floatMe",value:"left"});var ay=T(ai.iconPrefix+ai.icons.image.floatRight,{title:an.image.floatRight,event:"floatMe",value:"right"});var av=T(ai.iconPrefix+ai.icons.image.floatNone,{title:an.image.floatNone,event:"floatMe",value:"none"});var ar=T(ai.iconPrefix+ai.icons.image.shapeRounded,{title:an.image.shapeRounded,event:"imageClass",value:"img-rounded"});var az=T(ai.iconPrefix+ai.icons.image.shapeCircle,{title:an.image.shapeCircle,event:"imageClass",value:"img-circle"});var au=T(ai.iconPrefix+ai.icons.image.shapeThumbnail,{title:an.image.shapeThumbnail,event:"imageClass",value:"img-thumbnail"});var aB=T(ai.iconPrefix+ai.icons.image.bordered,{title:an.image.bordered,event:"imageClass",value:"img-bordered"});var aA=T(ai.iconPrefix+ai.icons.image.shapeNone,{title:an.image.shapeNone,event:"imageShape",value:""});var at=T(ai.iconPrefix+ai.icons.image.remove,{title:an.image.remove,event:"removeMedia",value:"none"});var ax='<div class="btn-group">'+ap+ay+av+'</div><div class="btn-group">'+ar+az+au+aB+aA+'</div><div class="btn-group">'+at+"</div>";return Y("note-image-popover",ax)};var aj=function(){var aq=A("<div />");for(var ap=0,ao=ai.airPopover.length;ap<ao;ap++){var aw=ai.airPopover[ap];var at=A('<div class="note-'+aw[0]+' btn-group">');for(var ar=0,av=aw[1].length;ar<av;ar++){var au=A(ad[aw[1][ar]](an,ai));au.attr("data-name",aw[1][ar]);at.append(au)}aq.append(at)}return Y("note-air-popover",aq.children())};var al=A('<div class="note-popover" />');al.append(am());al.append(ak());if(ai.airMode){al.append(aj())}return al};var ag=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'};var W=function(am,ak){var al="note-shortcut-col col-xs-6 note-shortcut-";var ai=[];for(var aj in ak){if(ak.hasOwnProperty(aj)){ai.push("<tr><td>"+ak[aj].kbd+"</td><td>"+ak[aj].text+"</td></tr>")}}return"<thead><tr><th>"+am+"</th><th>(keys)</th></tr></thead><tbody>"+ai.join("")+"</tbody>"};var N=function(aj){var ai=[{kbd:" + B",text:aj.font.bold},{kbd:" + I",text:aj.font.italic},{kbd:" + U",text:aj.font.underline},{kbd:" + \\",text:aj.font.clear}];return W(aj.shortcut.textFormatting,ai)};var af=function(aj){var ai=[{kbd:" + Z",text:aj.history.undo},{kbd:" +  + Z",text:aj.history.redo},{kbd:" + ]",text:aj.paragraph.indent},{kbd:" + [",text:aj.paragraph.outdent},{kbd:" + ENTER",text:aj.hr.insert}];return W(aj.shortcut.action,ai)};var aa=function(aj){var ai=[{kbd:" +  + L",text:aj.paragraph.left},{kbd:" +  + E",text:aj.paragraph.center},{kbd:" +  + R",text:aj.paragraph.right},{kbd:" +  + J",text:aj.paragraph.justify},{kbd:" +  + NUM7",text:aj.lists.ordered},{kbd:" +  + NUM8",text:aj.lists.unordered}];return W(aj.shortcut.paragraphFormatting,ai)};var ac=function(aj){var ai=[{kbd:" + NUM0",text:aj.style.normal},{kbd:" + NUM1",text:aj.style.h1},{kbd:" + NUM2",text:aj.style.h2},{kbd:" + NUM3",text:aj.style.h3},{kbd:" + NUM4",text:aj.style.h4},{kbd:" + NUM5",text:aj.style.h5},{kbd:" + NUM6",text:aj.style.h6}];return W(aj.shortcut.documentStyle,ai)};var R=function(am,ai){var ak=ai.extraKeys;var al=[];for(var aj in ak){if(ak.hasOwnProperty(aj)){al.push({kbd:aj,text:ak[aj]})}}return W(am.shortcut.extraKeys,al)};var ae=function(ak,ai){var aj=['<table class="striped hoverable">'+af(ak,ai)+"</table>",'<table class="striped hoverable">'+ac(ak,ai)+"</table>",'<table class="striped hoverable">'+N(ak,ai)+"</table>",'<table class="striped hoverable">'+aa(ak,ai)+"</table>"].join("<br>");if(ai.extraKeys){}return aj};var X=function(ai){return ai.replace(//g,"Ctrl").replace(//g,"Shift")};var Z={image:function(an,aj){var al="";if(aj.maximumImageFileSize){var ak=Math.floor(Math.log(aj.maximumImageFileSize)/Math.log(1024));var am=(aj.maximumImageFileSize/Math.pow(1024,ak)).toFixed(2)*1+"  KMGTP"[ak]+"B";al="<small>"+an.image.maximumFileSize+" : "+am+"</small>"}var ai='<div class="row"><div class="col s12"><div class="file-field input-field"><div class="btn"><span>'+an.image.image+'</span><input class="note-image-input" name="files" type="file" /></div><div class="file-path-wrapper"><input class="file-path" type="text" /></div></div></div></div><div class="row"><div class="input-field col s12"><input class="note-image-url" type="text" /><label>'+an.image.url+"</label></div></div>";var ao='<button href="#" class="waves-effect waves-light btn note-image-btn disabled" disabled>'+an.image.insert+'</button><button class="waves-effect waves-light btn btnClose">'+an.shortcut.close+"</button>";return ah("note-image-dialog",an.image.insert,ai,ao)},link:function(ak,aj){var ai='<div class="row"><div class="input-field col s12"><input class="note-link-text" type="text" /><label>'+ak.link.textToDisplay+'</label></div></div><div class="row"><div class="input-field col s12"><input class="note-link-url" type="text" value="http://" /><label class="active">'+ak.link.url+"</label></div></div>"+(!aj.disableLinkTarget?'<div class="row"><div class="col s12"><input type="checkbox" id="'+materialUniqueId+'-noteInsertLinkNewWindow" checked="checked" /><label for="'+materialUniqueId+'-noteInsertLinkNewWindow">'+ak.link.openInNewWindow+"</label></div></div>":"");var al='<button href="#" class="waves-effect waves-light btn note-link-btn disabled" disabled>'+ak.link.insert+'</button><button class="waves-effect waves-light btn btnClose">'+ak.shortcut.close+"</button>";return ah("note-link-dialog",ak.link.insert,ai,al)},help:function(ak,aj){var ai=(L.isMac?ae(ak,aj):X(ae(ak,aj)));var al='<button href="#" class="waves-effect waves-light btn modal-close">'+ak.shortcut.close+"</button>";return ah("note-help-dialog",ak.shortcut.shortcuts,ai,al)}};var O=function(ak,ai){var aj="";A.each(Z,function(al,am){aj+=am(ak,ai)});return'<div class="note-dialog">'+aj+"</div>"};var V=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'};var U=function(ai){if(L.isMac){ai=ai.replace("CMD","").replace("SHIFT","")}return ai.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")};var ab=function(aj,ak,ai){A(document).ready(function(){var am=p.invertObject(ak);var al=aj.find(".btn");console.log(aj);al.each(function(ao,aq){var ap=A(aq);var an=am[ap.data("event")];var ar=ap.attr("title");if(an){ap.attr("data-tooltip",function(au,at){ar=ar+" ("+U(an)+")";A(this).removeAttr("title");return ar})}ap.attr("data-position","bottom");ap.attr("data-tooltip",ar);ap.removeAttr("title")}).ckTooltip({container:aj,position:"top",delay:30})})};var S=function(al,ai){var aj=ai.colors;var ak=ai.colorTitles;al.find(".note-color-palette").each(function(){var au=A(this),ar=au.attr("data-target-event");var ao=[];for(var ay=0,at=aj.length;ay<at;ay++){var am=aj[ay];var aq=ak[ay];var av=[];for(var an=0,ax=am.length;an<ax;an++){var ap=am[an];var aw=aq[an];av.push(['<button type="button" class="note-color-btn" style="background-color:',ap,';" data-event="',ar,'" data-value="',ap,'" data-description="',aw,'" data-toggle="button" tabindex="-1"></button>'].join(""))}ao.push('<div class="note-color-row">'+av.join("")+"</div>")}au.html(ao.join(""));au.find("button").mouseenter(function(){au.siblings(".colorName").html(A(this).data("description"))});au.mouseleave(function(){A(this).siblings(".colorName").html("")})})};this.createLayoutByAirMode=function(al,aq){var ap=aq.langInfo;var ao=aq.keyMap[L.isMac?"mac":"pc"];var ai=p.uniqueId();al.addClass("note-air-editor note-editable");al.attr({id:"note-editor-"+ai,contentEditable:true});var an=document.body;var am=A(Q(ap,aq));am.addClass("note-air-layout");am.attr("id","note-popover-"+ai);am.appendTo(an);ab(am,ao);S(am,aq);var aj=A(ag());aj.addClass("note-air-layout");aj.attr("id","note-handle-"+ai);aj.appendTo(an);var ak=A(O(ap,aq));ak.addClass("note-air-layout");ak.attr("id","note-dialog-"+ai);ak.find("button.close, a.modal-close").click(function(){A(this).closest(".modal").modal("close")});ak.appendTo(an)};this.createLayoutByFrame=function(av,ai){var ax=ai.langInfo;var ao=A('<div class="note-editor"></div>');if(ai.width){ao.width(ai.width)}if(ai.height>0){A('<div class="note-statusbar">'+(ai.disableResizeEditor?"":V())+"</div>").prependTo(ao)}var az=!av.is(":disabled");var aC=A('<div class="note-editable flow-text center-align" contentEditable="'+az+'"></div>').prependTo(ao);if(ai.height){aC.height(ai.height)}if(ai.direction){aC.attr("dir",ai.direction)}var al=av.attr("placeholder")||ai.placeholder;if(al){aC.attr("data-placeholder",al)}aC.html(a.html(av));A('<textarea class="note-codable"></textarea>').prependTo(ao);var aD=A('<div class="note-toolbar btn-toolbar" />');for(var ar=0,ay=ai.toolbar.length;ar<ay;ar++){var ap=ai.toolbar[ar][0];var aq=ai.toolbar[ar][1];var aB=A('<div class="note-'+ap+' btn-group" />');for(var aw=0,at=aq.length;aw<at;aw++){var an=ad[aq[aw]];if(!A.isFunction(an)){continue}var ak=A(an(ax,ai));ak.attr("data-name",aq[aw]);aB.append(ak)}aD.append(aB)}aD.prependTo(ao);var au=ai.keyMap[L.isMac?"mac":"pc"];S(aD,ai);ab(aD,au,"bottom");function am(){A(window).scroll(function(){var aL=ao.hasClass("fullscreen");if(aL){console.log("fullscreen");return false}var aO=ao.children(".note-toolbar");var aP=aO.outerHeight();var aE=ao.children(".note-editable");var aH=aE.outerHeight();var aI=ao.width;var aG,aF,aK;var aS,aR,aM;var aN;var aJ;var aQ;aQ=A("."+ai.otherStaticBarClass).outerHeight();if(!aQ){aQ=0}aN=A(document).scrollTop();aG=aO.offset().top;aF=ao.offset().top;aK=aF+aH;aS=aG-aQ;aM=aK-aQ;aR=aF-aQ;if((aN>aS)&&(aN<aM)){aJ=aN-ao.offset().top+aQ;aO.css({top:aJ+"px","z-index":2000})}else{if((aN<aG)&&(aN<aM)){aO.css({top:0,"z-index":1052});if(aN>aR){aJ=aN-ao.offset().top+aQ;aO.css({top:aJ+"px","z-index":2000})}}}})}if(ai.followingToolbar){am()}var aj=A(Q(ax,ai)).prependTo(ao);S(aj,ai);ab(aj,au);A(ag()).prependTo(ao);var aA=A(O(ax,ai)).prependTo(ao);aA.find("button.close, a.modal-close").click(function(){A(this).closest(".modal").modal("close")});A('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(ao);ao.insertAfter(av);av.hide()};this.hasNoteEditor=function(ai){return this.noteEditorFromHolder(ai).length>0};this.noteEditorFromHolder=function(ai){if(ai.hasClass("note-air-editor")){return ai}else{if(ai.next().hasClass("note-editor")){return ai.next()}else{return A()}}};this.createLayout=function(aj,ai){if(ai.airMode){this.createLayoutByAirMode(aj,ai)}else{this.createLayoutByFrame(aj,ai)}};this.layoutInfoFromHolder=function(ai){var aj=this.noteEditorFromHolder(ai);if(!aj.length){return}aj.data("holder",ai);return a.buildLayoutInfo(aj)};this.removeLayout=function(aj,ak,ai){if(ai.airMode){aj.removeClass("note-air-editor note-editable").removeAttr("id contentEditable");ak.popover().remove();ak.handle().remove();ak.dialog().remove()}else{aj.html(ak.editable().html());ak.editor().remove();aj.show()}};this.getTemplate=function(){return{button:P,iconButton:T,dialog:ah}};this.addButtonInfo=function(ai,aj){ad[ai]=aj};this.addDialogInfo=function(aj,ai){Z[aj]=ai}};A.materialnote=A.materialnote||{};A.extend(A.materialnote,C);var D=new f();var n=new e();A.extend(A.materialnote,{renderer:D,eventHandler:n,core:{agent:L,list:q,dom:a,range:i},pluginEvents:{},plugins:[]});A.materialnote.addPlugin=function(N){A.materialnote.plugins.push(N);if(N.buttons){A.each(N.buttons,function(O,P){D.addButtonInfo(O,P)})}if(N.dialogs){A.each(N.dialogs,function(O,P){D.addDialogInfo(O,P)})}if(N.events){A.each(N.events,function(O,P){A.materialnote.pluginEvents[O]=P})}if(N.langs){A.each(N.langs,function(O,P){if(A.materialnote.lang[O]){A.extend(A.materialnote.lang[O],P)}})}if(N.options){A.extend(A.materialnote.options,N.options)}};A.fn.extend({materialnote:function(){var V=A.type(q.head(arguments));var N=V==="string";var W=V==="object";var Y=W?q.head(arguments):{};Y=A.extend({},A.materialnote.options,Y);Y.icons=A.extend({},A.materialnote.options.icons,Y.icons);Y.langInfo=A.extend(true,{},A.materialnote.lang["en-US"],A.materialnote.lang[Y.lang]);if(!N&&W){for(var R=0,T=A.materialnote.plugins.length;R<T;R++){var S=A.materialnote.plugins[R];if(Y.plugin[S.name]){A.materialnote.plugins[R]=A.extend(true,S,Y.plugin[S.name])}}}this.each(function(Z,aa){materialUniqueId=A(aa).attr("id");var ab=A(aa);if(!D.hasNoteEditor(ab)){D.createLayout(ab,Y);var ac=D.layoutInfoFromHolder(ab);ab.data("layoutInfo",ac);n.attach(ac,Y);n.attachCustomEvent(ac,Y)}});var Q=this.first();if(Q.length){var O=D.layoutInfoFromHolder(Q);if(N){var X=q.head(q.from(arguments));var U=q.tail(q.from(arguments));var P=[X,O.editable()].concat(U);return n.invoke.apply(n,P)}else{if(Y.focus){O.editable().focus()}}}A(this).each(function(ae,ad){var af;var ah;var ag;var ac=false;if(A(ad).hasClass("note-air-editor")){var aa=A(this).attr("id");if(aa){aa=aa.substring(aa.lastIndexOf("-")+1,aa.length)}ad=A("#note-popover-"+aa).find(".note-air-popover");ah=ad.find("ul.tabs");af=ad.find("li.tab a");ag=A(ad).find(".popover-content button.dropdown");ac=true}else{ad=A(ad).next(".note-editor");ah=ad.find("ul.tabs");af=ad.find("li.tab a");ag=A(ad).find(".note-toolbar button.dropdown")}var ab=true;function Z(ai,ak){var al=A(ai).next("ul.dropdown-menu");var aj=A(ai).parent(".btn-group");al.slideUp(0);A(".preventDropClose").click(function(am){am.stopPropagation()});A(ai).click(function(aq){var au=Math.round(A(ai).parent(".btn-group").offset().left-ag.offset().left);var ao=parseInt(al.css("border-left-width"));var ar=ad.outerWidth();var am=ao;al.css({"max-width":ar+"px"});var at=al.outerWidth();var ap=at+au;if(ap>=ar){am=ap-ar;if(!ac){am=am+ao}}al.css({left:"-"+am+"px"});var an=true;if(al.is(":visible")){an=false}ak.find("ul.dropdown-menu").slideUp(200);if(an){al.slideToggle(200)}aq.stopPropagation()});af.unbind().click(function(am){ab=false})}A(window).click(function(ai){if(ab){ad.find("ul.dropdown-menu").slideUp(200)}ab=true;ai.stopPropagation()});ag.each(function(aj,ai){Z(ai,ad)});ah.tabs()});return this},code:function(P){if(P===undefined){var Q=this.first();if(!Q.length){return}var R=D.layoutInfoFromHolder(Q);var O=R&&R.editable();if(O&&O.length){var N=n.invoke("codeview.isActivated",R);n.invoke("codeview.sync",R);return N?R.codable().val():R.editable().html()}return a.value(Q)}this.each(function(U,T){var V=D.layoutInfoFromHolder(A(T));var S=V&&V.editable();if(S){S.html(P)}});return this},destroy:function(){this.each(function(N,P){var Q=A(P);if(!D.hasNoteEditor(Q)){return}var R=D.layoutInfoFromHolder(Q);var O=R.editor().data("options");n.detach(R,O);D.removeLayout(Q,R,O)});return this}})}));